<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Windows App SDK on Christian Amado's Blog</title><link>https://cmas.dev/tags/windows-app-sdk/</link><description>Recent content in Windows App SDK on Christian Amado's Blog</description><generator>Hugo -- gohugo.io</generator><language>es</language><lastBuildDate>Fri, 28 Mar 2025 00:00:00 -0300</lastBuildDate><atom:link href="https://cmas.dev/tags/windows-app-sdk/index.xml" rel="self" type="application/rss+xml"/><item><title>Construcción de un asistente contextual para escritorio usando IA local con acceso al sistema</title><link>https://cmas.dev/posts/2025-03-28-local-ai/</link><pubDate>Fri, 28 Mar 2025 00:00:00 -0300</pubDate><guid>https://cmas.dev/posts/2025-03-28-local-ai/</guid><description>&lt;p>La combinación de capacidades de &lt;strong>IA local&lt;/strong> (como modelos &lt;strong>ONNX&lt;/strong>) con APIs del sistema de &lt;strong>Windows&lt;/strong> abre la puerta al desarrollo de asistentes inteligentes capaces de entender el contexto del usuario y reaccionar en consecuencia. En este artículo se describe cómo crear un asistente de escritorio moderno con &lt;strong>WinUI 3&lt;/strong> que escuche el contenido del portapapeles, analice el texto localmente mediante inferencia con IA, y sugiera acciones o realice comandos con base en el resultado.&lt;/p>
&lt;p>Este enfoque funciona completamente offline, preservando privacidad y respondiendo en tiempo real.&lt;/p>
&lt;h2 id="escenario">Escenario&lt;/h2>
&lt;p>Se construye una app tipo widget flotante que:&lt;/p>
&lt;ul>
&lt;li>Detecta texto nuevo en el portapapeles&lt;/li>
&lt;li>Usa un modelo ONNX de clasificación de intención&lt;/li>
&lt;li>Sugiere acciones como: buscar, traducir, abrir app, copiar info, etc.&lt;/li>
&lt;li>Accede a procesos del sistema para acciones automatizadas&lt;/li>
&lt;/ul>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Windows 11&lt;/li>
&lt;li>Visual Studio 2022&lt;/li>
&lt;li>Windows App SDK + WinUI 3&lt;/li>
&lt;li>Microsoft.AI.MachineLearning + acceso a Windows.ApplicationModel.DataTransfer&lt;/li>
&lt;li>Modelo ONNX de clasificación (intención o NLP embebido)&lt;/li>
&lt;li>Permiso para acceder a procesos (System.Diagnostics)&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-crear-ventana-persistente-estilo-widget">Paso 1: Crear ventana persistente estilo Widget&lt;/h2>
&lt;p>Basado en el artículo anterior, crear ventana flotante:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">hwnd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">WindowNative&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetWindowHandle&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">this&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">appWindow&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">AppWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetFromWindowId&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">GetWindowIdForWindow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">this&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">appWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetPresenter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AppWindowPresenterKind&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CompactOverlay&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-2-capturar-texto-del-portapapeles">Paso 2: Capturar texto del portapapeles&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">DispatcherQueueTimer&lt;/span> &lt;span class="n">timer&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">DispatcherQueue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateTimer&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">string&lt;/span> &lt;span class="n">anterior&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">timer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Interval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">TimeSpan&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">FromSeconds&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">timer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Tick&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="kd">async&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">data&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Clipboard&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetContent&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StandardDataFormats&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">string&lt;/span> &lt;span class="n">texto&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetTextAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">texto&lt;/span> &lt;span class="p">!=&lt;/span> &lt;span class="n">anterior&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">anterior&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">texto&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">await&lt;/span> &lt;span class="n">EvaluarTexto&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">texto&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">timer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Start&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-3-evaluar-intención-con-modelo-onnx">Paso 3: Evaluar intención con modelo ONNX&lt;/h2>
&lt;p>Cargar modelo preentrenado de intención o clasificación:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">model&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">LearningModel&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">LoadFromFilePath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Assets/Modelos/clasificador.onnx&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">session&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">LearningModelSession&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">model&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">tensor&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">TensorString&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateFromArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">u&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="k">new&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">texto&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">binding&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">LearningModelBinding&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">session&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">binding&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;input_text&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">tensor&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ejecutar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">resultado&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">session&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">EvaluateAsync&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">binding&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Inferencia&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">salida&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">resultado&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Outputs&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;output_label&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">TensorString&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">prediccion&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">salida&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetAsVectorView&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">FirstOrDefault&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-4-mostrar-sugerencia-en-ui">Paso 4: Mostrar sugerencia en UI&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">SugerenciaText&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;¿Deseás {prediccion}?&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Agregar botón según intención:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">prediccion&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;traducir&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Traducir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">texto&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">prediccion&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;buscar&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Process&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Start&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">ProcessStartInfo&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;https://www.bing.com/search?q=&amp;#34;&lt;/span> &lt;span class="p">+&lt;/span> &lt;span class="n">Uri&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">EscapeDataString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">texto&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">UseShellExecute&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-5-automatización-de-acciones">Paso 5: Automatización de acciones&lt;/h2>
&lt;p>Acceder a procesos abiertos:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">procesos&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Process&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetProcesses&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">foreach&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">var&lt;/span> &lt;span class="n">proc&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">procesos&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">proc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ProcessName&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;notepad&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">proc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Kill&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="c1">// o traer al frente&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ejemplo: copiar texto detectado como nombre de archivo → abrir archivo.&lt;/p>
&lt;h2 id="paso-6-ui-simplificada-con-feedback">Paso 6: UI simplificada con feedback&lt;/h2>
&lt;p>En XAML:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;StackPanel&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;TextBlock&lt;/span> &lt;span class="na">x:Name=&lt;/span>&lt;span class="s">&amp;#34;TextoDetectado&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;TextBlock&lt;/span> &lt;span class="na">x:Name=&lt;/span>&lt;span class="s">&amp;#34;SugerenciaText&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Button&lt;/span> &lt;span class="na">Content=&lt;/span>&lt;span class="s">&amp;#34;Ejecutar acción&amp;#34;&lt;/span> &lt;span class="na">Click=&lt;/span>&lt;span class="s">&amp;#34;Ejecutar_Click&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/StackPanel&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Actualizar en tiempo real:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">TextoDetectado&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">texto&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Asistentes de productividad (resumen, acción sugerida)&lt;/li>
&lt;li>IA contextual para tareas repetitivas&lt;/li>
&lt;li>Reemplazo de accesos rápidos con comandos inteligentes&lt;/li>
&lt;li>Interfaces adaptativas para entornos sin conectividad&lt;/li>
&lt;/ul>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Permitir desactivar portapapeles automático&lt;/li>
&lt;li>Evitar acciones destructivas (confirmar antes de cerrar apps)&lt;/li>
&lt;li>Mostrar claramente el resultado de la inferencia&lt;/li>
&lt;li>Ejecutar tareas en background sin bloquear la UI&lt;/li>
&lt;li>No ejecutar si la confianza es baja (basado en score)&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>La construcción de un asistente inteligente de escritorio que combine IA local con APIs del sistema permite ofrecer experiencias proactivas, eficientes y altamente personalizadas. &lt;strong>WinUI 3&lt;/strong> junto con &lt;strong>Windows ML&lt;/strong> y la integración con funcionalidades como el portapapeles, procesos y UI flotante, ofrece un entorno ideal para crear agentes inteligentes que funcionan sin depender de la nube.&lt;/p></description></item><item><title>Integración de inferencia local ONNX con Windows ML en apps modernas</title><link>https://cmas.dev/posts/2025-03-21-onnx-windows-ml/</link><pubDate>Fri, 21 Mar 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-03-21-onnx-windows-ml/</guid><description>&lt;p>La inteligencia artificial en el entorno de escritorio ya no está limitada a la nube. &lt;strong>Windows&lt;/strong> proporciona soporte nativo para la ejecución de modelos &lt;strong>ONNX&lt;/strong> directamente desde una app &lt;strong>WinUI 3&lt;/strong> utilizando &lt;strong>Windows ML&lt;/strong>. Esto permite realizar inferencia local con alto rendimiento y sin necesidad de conexión a internet, ideal para escenarios de privacidad, baja latencia o ejecución offline.&lt;/p>
&lt;p>En este artículo se describe cómo integrar un modelo &lt;strong>ONNX&lt;/strong> a una app moderna, cómo usar la &lt;strong>API&lt;/strong> de &lt;strong>Windows ML&lt;/strong> y cómo estructurar un flujo de inferencia optimizado con soporte para entrada y salida de datos reales.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Windows 11 (recomendado build 22621+)&lt;/li>
&lt;li>Visual Studio 2022 con Windows App SDK 1.3+&lt;/li>
&lt;li>Proyecto WinUI 3 empaquetado (MSIX)&lt;/li>
&lt;li>Referencia al paquete &lt;code>Microsoft.AI.MachineLearning&lt;/code>&lt;/li>
&lt;li>Modelo ONNX compatible (puede ser descargado de onnxruntime zoo)&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-agregar-el-paquete-nuget-de-windows-ml">Paso 1: Agregar el paquete NuGet de Windows ML&lt;/h2>
&lt;p>Agregar al proyecto:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Install-Package Microsoft.AI.MachineLearning
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto permite cargar y ejecutar modelos ONNX directamente desde código.&lt;/p>
&lt;h2 id="paso-2-copiar-el-modelo-onnx-al-proyecto">Paso 2: Copiar el modelo ONNX al proyecto&lt;/h2>
&lt;p>Ejemplo: &lt;code>modelo_mnist.onnx&lt;/code> copiado a la carpeta &lt;code>Assets/ML&lt;/code>&lt;/p>
&lt;p>Configurar en propiedades:&lt;/p>
&lt;ul>
&lt;li>Build Action: Content&lt;/li>
&lt;li>Copy to Output Directory: Copy if newer&lt;/li>
&lt;/ul>
&lt;h2 id="paso-3-cargar-el-modelo-onnx">Paso 3: Cargar el modelo ONNX&lt;/h2>
&lt;p>Importar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">Microsoft.AI.MachineLearning&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Cargar desde archivo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">StorageFile&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetFileFromApplicationUriAsync&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">Uri&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ms-appx:///Assets/ML/modelo_mnist.onnx&amp;#34;&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">session&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">LearningModelSession&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateFromModel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">LearningModel&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">LoadFromFilePath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Path&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto crea una sesión de inferencia desde el modelo.&lt;/p>
&lt;h2 id="paso-4-preparar-entrada-para-inferencia">Paso 4: Preparar entrada para inferencia&lt;/h2>
&lt;p>Ejemplo para imagen de 28x28 píxeles escala de grises:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">float&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="n">input&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="kt">float&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="p">*&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="p">*&lt;/span> &lt;span class="m">28&lt;/span> &lt;span class="p">*&lt;/span> &lt;span class="m">28&lt;/span>&lt;span class="p">];&lt;/span> &lt;span class="c1">// NCHW&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Rellenar input con los valores de píxeles normalizados (0.0–1.0)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">tensor&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">TensorFloat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateFromArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">u&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">u&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">28&lt;/span>&lt;span class="n">u&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">28&lt;/span>&lt;span class="n">u&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="n">input&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">binding&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">LearningModelBinding&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">session&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">binding&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Input3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">tensor&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-5-ejecutar-inferencia">Paso 5: Ejecutar inferencia&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">session&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">EvaluateAsync&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">binding&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Inferencia1&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">outputTensor&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Outputs&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;Plus214_Output_0&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">TensorFloat&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">output&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">outputTensor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetAsVectorView&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">predictedIndex&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ToList&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">IndexOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Max&lt;/span>&lt;span class="p">());&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto retorna el índice con mayor probabilidad (en este caso, el dígito 0–9).&lt;/p>
&lt;h2 id="paso-6-mostrar-resultados-en-ui">Paso 6: Mostrar resultados en UI&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">ResultadoText&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;Predicción: {predictedIndex}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>En XAML:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;StackPanel&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Image&lt;/span> &lt;span class="na">x:Name=&lt;/span>&lt;span class="s">&amp;#34;InputPreview&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;TextBlock&lt;/span> &lt;span class="na">x:Name=&lt;/span>&lt;span class="s">&amp;#34;ResultadoText&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/StackPanel&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-7-optimización-y-aceleración">Paso 7: Optimización y aceleración&lt;/h2>
&lt;p>Windows ML usa DirectML y soporte para GPU si está disponible. No se requiere configuración extra: el runtime lo detecta automáticamente.&lt;/p>
&lt;p>Validar el dispositivo utilizado:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">deviceKind&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">session&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceKind&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ToString&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="c1">// CPU, GPU, DirectML&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-8-alternativas-para-modelos">Paso 8: Alternativas para modelos&lt;/h2>
&lt;ul>
&lt;li>Convertir PyTorch / TensorFlow → ONNX&lt;/li>
&lt;li>Usar modelos preentrenados: &lt;code>squeezenet&lt;/code>, &lt;code>resnet18&lt;/code>, &lt;code>mobilenetv2&lt;/code>&lt;/li>
&lt;li>Exportar modelos propios con herramientas como &lt;code>onnxruntime-tools&lt;/code> o &lt;code>tf2onnx&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Clasificación de imágenes (productos, documentos)&lt;/li>
&lt;li>Detección de anomalías locales&lt;/li>
&lt;li>Asistentes inteligentes offline&lt;/li>
&lt;li>Modelos de NLP ligeros ejecutados localmente&lt;/li>
&lt;li>Reconocimiento de escritura a mano o números&lt;/li>
&lt;/ul>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Validar entradas antes de ejecutar inferencia&lt;/li>
&lt;li>Manejar fallback si no hay aceleración GPU&lt;/li>
&lt;li>No cargar el modelo en cada inferencia (persistir sesión)&lt;/li>
&lt;li>Reducir tamaño del modelo con quantization si es posible&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>La integración de &lt;strong>ONNX&lt;/strong> y &lt;strong>Windows ML&lt;/strong> en aplicaciones modernas &lt;strong>WinUI 3&lt;/strong> permite ejecutar inferencia local de modelos de IA de forma nativa, segura y sin latencia de red. Esto convierte a &lt;strong>Windows&lt;/strong> en una plataforma ideal para aplicaciones inteligentes en el borde, desde escritorios empresariales hasta dispositivos autónomos. El soporte de &lt;strong>Windows App SDK&lt;/strong> lo hace accesible a cualquier desarrollador de apps modernas.&lt;/p></description></item><item><title>Integración con servicios locales vía App Services y extensión de funcionalidades entre apps</title><link>https://cmas.dev/posts/2025-03-14-winui-apps-services/</link><pubDate>Fri, 14 Mar 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-03-14-winui-apps-services/</guid><description>&lt;p>En &lt;strong>Windows&lt;/strong>, las aplicaciones modernas pueden compartir capacidades y comunicarse entre sí a través de &lt;strong>App Services&lt;/strong>. Esta tecnología permite que una app ofrezca un servicio que puede ser invocado por otra app —incluso si están empaquetadas por separado— de forma segura y asincrónica.&lt;/p>
&lt;p>Este enfoque es ideal para dividir funcionalidades entre componentes, implementar microservicios locales o permitir extensibilidad entre apps del mismo desarrollador. &lt;strong>Windows App SDK&lt;/strong> conserva la compatibilidad con App Services, permitiendo a las apps modernas establecer esta comunicación sin usar sockets ni canalizaciones personalizadas.&lt;/p>
&lt;p>Este artículo explora cómo implementar un servicio local entre dos apps modernas, incluyendo su declaración, registro, activación y comunicación estructurada con respuestas.&lt;/p>
&lt;h2 id="escenario">Escenario&lt;/h2>
&lt;p>Una app &amp;ldquo;Cliente&amp;rdquo; quiere consultar datos a una app &amp;ldquo;Servicio&amp;rdquo; (por ejemplo, conversión de monedas). El servicio se mantiene empaquetado con su propio MSIX y ofrece un punto de entrada App Service.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Dos apps empaquetadas (Cliente y Servicio)&lt;/li>
&lt;li>Ambas deben declararse en sus respectivos manifiestos&lt;/li>
&lt;li>Se necesita control del namespace y entrypoint de la app de servicio&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-crear-la-app-de-servicio">Paso 1: Crear la app de servicio&lt;/h2>
&lt;p>Implementar clase &lt;code>IBackgroundTask&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span> &lt;span class="kd">sealed&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">ServicioConversion&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">IBackgroundTask&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">public&lt;/span> &lt;span class="kd">async&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">IBackgroundTaskInstance&lt;/span> &lt;span class="n">taskInstance&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">deferral&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">taskInstance&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetDeferral&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">details&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">taskInstance&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TriggerDetails&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">AppServiceTriggerDetails&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">connection&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">details&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AppServiceConnection&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">msg&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">connection&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RequestReceivedTask&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">msg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Request&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Message&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ContainsKey&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;monto&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">double&lt;/span> &lt;span class="n">monto&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Convert&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ToDouble&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">msg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Request&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Message&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;monto&amp;#34;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">resultado&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">monto&lt;/span> &lt;span class="p">*&lt;/span> &lt;span class="m">0.92&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">respuesta&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ValueSet&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">respuesta&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;resultado&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">resultado&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ToString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;F2&amp;#34;&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">await&lt;/span> &lt;span class="n">msg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Request&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SendResponseAsync&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">respuesta&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">deferral&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Complete&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-2-declarar-app-service-en-el-manifiesto">Paso 2: Declarar App Service en el manifiesto&lt;/h2>
&lt;p>En el &lt;code>Package.appxmanifest&lt;/code> del servicio:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.appService&amp;#34;&lt;/span> &lt;span class="na">EntryPoint=&lt;/span>&lt;span class="s">&amp;#34;ServicioApp.ServicioConversion&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;AppService&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;Servicio.Conversion&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>El &lt;code>EntryPoint&lt;/code> debe coincidir con el namespace completo.&lt;/p>
&lt;h2 id="paso-3-crear-app-cliente">Paso 3: Crear app cliente&lt;/h2>
&lt;p>Desde la app cliente, establecer conexión:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">connection&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">AppServiceConnection&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">AppServiceName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Servicio.Conversion&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PackageFamilyName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;ServicioApp_xyz123&amp;#34;&lt;/span> &lt;span class="c1">// copiar desde appxmanifest generado&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">estado&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">connection&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">OpenAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">estado&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="n">AppServiceConnectionStatus&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Success&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">datos&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ValueSet&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">datos&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;monto&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;100&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">respuesta&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">connection&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SendMessageAsync&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">datos&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">valorConvertido&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">respuesta&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Message&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;resultado&amp;#34;&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ResultadoText&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;Valor: {valorConvertido}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ResultadoText&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;Error de conexión: {estado}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-4-empaquetar-y-firmar-ambas-apps">Paso 4: Empaquetar y firmar ambas apps&lt;/h2>
&lt;p>Ambas deben estar empaquetadas, firmadas e instaladas. En desarrollo, puede usarse instalación local con certificados de prueba.&lt;/p>
&lt;h2 id="paso-5-comunicación-bidireccional">Paso 5: Comunicación bidireccional&lt;/h2>
&lt;p>El servicio puede devolver múltiples valores, y el cliente puede enviar instrucciones con múltiples claves.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">datos&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;comando&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;convertir&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">datos&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;origen&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;USD&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">datos&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;destino&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;EUR&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>El servicio puede interpretar estas claves para ejecutar lógica diferente.&lt;/p>
&lt;h2 id="casos-de-uso">Casos de uso&lt;/h2>
&lt;ul>
&lt;li>Apps que extienden funcionalidades de otra (plugin, extensiones)&lt;/li>
&lt;li>Apps que centralizan lógica compartida (autenticación, licencia, almacenamiento seguro)&lt;/li>
&lt;li>Clientes ligeros que consultan una app “nodo” local con base de datos&lt;/li>
&lt;li>Comunicación entre app de escritorio y servicio auxiliar en background&lt;/li>
&lt;/ul>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Definir claves de mensajes con nombres únicos y versionados&lt;/li>
&lt;li>Validar inputs antes de ejecutar operaciones&lt;/li>
&lt;li>Usar &lt;code>try/catch&lt;/code> para proteger el canal de comunicación&lt;/li>
&lt;li>No mantener conexiones abiertas más allá de lo necesario&lt;/li>
&lt;li>Revisar que la app de servicio esté activa o instalada correctamente&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>&lt;strong>App Services&lt;/strong> permite una arquitectura modular para aplicaciones modernas en &lt;strong>Windows&lt;/strong>, fomentando la reutilización, extensibilidad y separación de responsabilidades. Este enfoque es robusto, seguro y bien integrado en el modelo &lt;strong>MSIX&lt;/strong>, facilitando aplicaciones compuestas que se comunican entre sí de forma directa y eficiente.&lt;/p></description></item><item><title>Implementación de Background Tasks persistentes en apps modernas</title><link>https://cmas.dev/posts/2025-03-07-winui-background-tasks/</link><pubDate>Fri, 07 Mar 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-03-07-winui-background-tasks/</guid><description>&lt;p>Las apps modernas no siempre necesitan estar en primer plano para ofrecer valor. Muchas tareas pueden ejecutarse en segundo plano: desde sincronizar datos, recibir notificaciones push, recolectar telemetría o mantener información actualizada. &lt;strong>Windows App SDK&lt;/strong>, junto con el modelo de &lt;strong>Background Tasks&lt;/strong>, permite que las aplicaciones &lt;strong>WinUI 3&lt;/strong> implementen lógica persistente y autónoma en segundo plano, sin requerir una ventana activa.&lt;/p>
&lt;p>Este artículo explica cómo crear y registrar tareas en segundo plano usando temporizadores, eventos del sistema o push notifications (RAW), y cómo integrarlas en una aplicación moderna empaquetada.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Windows 11&lt;/li>
&lt;li>Visual Studio 2022+&lt;/li>
&lt;li>Proyecto WinUI 3 empaquetado (MSIX)&lt;/li>
&lt;li>Windows App SDK 1.3+&lt;/li>
&lt;li>Conocimiento de manifiesto MSIX&lt;/li>
&lt;/ul>
&lt;h2 id="tipos-de-background-tasks">Tipos de Background Tasks&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>TimeTrigger&lt;/strong>: se ejecuta a intervalos (mínimo 15 min)&lt;/li>
&lt;li>&lt;strong>MaintenanceTrigger&lt;/strong>: cuando el sistema está inactivo&lt;/li>
&lt;li>&lt;strong>PushTrigger (Raw Push)&lt;/strong>: notificación sin UI&lt;/li>
&lt;li>&lt;strong>SystemTrigger&lt;/strong>: conectado a eventos del sistema&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-crear-clase-de-tarea-en-segundo-plano">Paso 1: Crear clase de tarea en segundo plano&lt;/h2>
&lt;p>Agregar nuevo archivo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span> &lt;span class="kd">sealed&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">MiBackgroundTask&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">IBackgroundTask&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">public&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">Run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">IBackgroundTaskInstance&lt;/span> &lt;span class="n">taskInstance&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Lógica que se ejecuta en segundo plano&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">deferral&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">taskInstance&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetDeferral&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Ejemplo: guardar log&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">File&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AppendAllText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;C:\Logs\tasklog.txt&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">$&amp;#34;Ejecutado {DateTime.Now}
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">deferral&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Complete&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-2-registrar-la-tarea-desde-la-app-principal">Paso 2: Registrar la tarea desde la app principal&lt;/h2>
&lt;p>En &lt;code>App.xaml.cs&lt;/code> o &lt;code>MainWindow.xaml.cs&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">builder&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">BackgroundTaskBuilder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;MiTareaTimer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">TaskEntryPoint&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;NombreApp.MiBackgroundTask&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetTrigger&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">TimeTrigger&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">15&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">));&lt;/span> &lt;span class="c1">// cada 15 min&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">BackgroundTaskRegistration&lt;/span> &lt;span class="n">task&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Register&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Este código registra la tarea al iniciar la app.&lt;/p>
&lt;h2 id="paso-3-declarar-extensión-en-packageappxmanifest">Paso 3: Declarar extensión en &lt;code>Package.appxmanifest&lt;/code>&lt;/h2>
&lt;p>Abrir el manifiesto en modo texto y agregar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.backgroundTasks&amp;#34;&lt;/span> &lt;span class="na">EntryPoint=&lt;/span>&lt;span class="s">&amp;#34;NombreApp.MiBackgroundTask&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;BackgroundTasks&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Task&lt;/span> &lt;span class="na">Type=&lt;/span>&lt;span class="s">&amp;#34;timer&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/BackgroundTasks&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto informa al sistema que la app ejecuta tareas temporizadas.&lt;/p>
&lt;h2 id="paso-4-usar-raw-push-notifications">Paso 4: Usar Raw Push Notifications&lt;/h2>
&lt;p>Configurar canal:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">channel&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">PushNotificationChannelManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreatePushNotificationChannelForApplicationAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Debug&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WriteLine&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;URI canal push: &amp;#34;&lt;/span> &lt;span class="p">+&lt;/span> &lt;span class="n">channel&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Uri&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Registrar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetTrigger&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">PushNotificationTrigger&lt;/span>&lt;span class="p">());&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;PushTask&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TaskEntryPoint&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;NombreApp.MiPushTask&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Register&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Desde backend, enviar notificación RAW con cuerpo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;toast&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;visual&amp;gt;&amp;lt;binding&lt;/span> &lt;span class="na">template=&lt;/span>&lt;span class="s">&amp;#34;ToastText01&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&amp;lt;text&amp;gt;&lt;/span>Push Recibido&lt;span class="nt">&amp;lt;/text&amp;gt;&amp;lt;/binding&amp;gt;&amp;lt;/visual&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/toast&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-5-ejecutar-tareas-en-mantenimiento">Paso 5: Ejecutar tareas en mantenimiento&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetTrigger&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">MaintenanceTrigger&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">15&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">));&lt;/span> &lt;span class="c1">// cada 15 mins cuando el sistema está idle&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Usado para limpieza, archivado, backups, etc.&lt;/p>
&lt;h2 id="paso-6-monitorear-ejecución">Paso 6: Monitorear ejecución&lt;/h2>
&lt;p>Registrar evento de monitoreo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Completed&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Debug&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WriteLine&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">$&amp;#34;Tarea completada: {s.Name}&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ver eventos del sistema en Visor de Eventos &amp;gt; Aplicaciones y servicios &amp;gt; Microsoft &amp;gt; Windows &amp;gt; BackgroundTaskInfrastructure&lt;/p>
&lt;h2 id="consideraciones-importantes">Consideraciones importantes&lt;/h2>
&lt;ul>
&lt;li>Las tareas en segundo plano no pueden mostrar UI&lt;/li>
&lt;li>Si el sistema está en ahorro de batería, pueden ser diferidas&lt;/li>
&lt;li>El &lt;code>EntryPoint&lt;/code> debe estar bien definido y coincidir con el namespace&lt;/li>
&lt;/ul>
&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Sincronización periódica con backend&lt;/li>
&lt;li>Recibir notificaciones silenciosas&lt;/li>
&lt;li>Reintentar envíos fallidos&lt;/li>
&lt;li>Registro de métricas, backups, auditorías&lt;/li>
&lt;/ul>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Siempre solicitar &lt;code>GetDeferral()&lt;/code> si la tarea es async&lt;/li>
&lt;li>No hacer lógica intensiva que exceda el tiempo permitido (30 seg máx)&lt;/li>
&lt;li>Registrar tareas solo una vez y verificar si ya existen&lt;/li>
&lt;li>No abusar de intervalos mínimos (respetar consumo energético)&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>La implementación de &lt;strong>Background Tasks&lt;/strong> en apps modernas permite extender su funcionalidad más allá del primer plano, ejecutando lógica útil, context-aware y controlada por el sistema. Usando &lt;strong>Windows App SDK&lt;/strong>, es posible construir tareas eficientes, reactivas y persistentes que mejoran la autonomía y robustez de la aplicación.&lt;/p></description></item><item><title>Empaquetado de apps modernas con MSIX y configuración avanzada del manifiesto</title><link>https://cmas.dev/posts/2025-02-28-winui-packaging-msix/</link><pubDate>Fri, 28 Feb 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-02-28-winui-packaging-msix/</guid><description>&lt;p>&lt;strong>MSIX&lt;/strong> es el formato de empaquetado moderno para aplicaciones &lt;strong>Windows&lt;/strong>. Ofrece instalación limpia, actualización controlada, aislamiento seguro, y registro transparente de recursos y capacidades. Para aplicaciones desarrolladas con &lt;strong>Windows App SDK&lt;/strong> y &lt;strong>WinUI 3&lt;/strong>, el uso de &lt;strong>MSIX&lt;/strong> no es opcional, es el estándar recomendado para integrarse completamente al ecosistema del sistema operativo moderno.&lt;/p>
&lt;p>Este artículo aborda cómo empaquetar una app moderna con &lt;strong>MSIX&lt;/strong> desde &lt;strong>Visual Studio&lt;/strong>, y cómo configurar el manifiesto del paquete (&lt;code>Package.appxmanifest&lt;/code>) para habilitar capacidades avanzadas como protocolos personalizados, extensiones del sistema, iconografía personalizada y más.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Windows 11&lt;/li>
&lt;li>Visual Studio 2022 con workload “Desarrollo para escritorio con C++” y MSIX Packaging Tools&lt;/li>
&lt;li>Windows App SDK 1.3+&lt;/li>
&lt;li>Proyecto de tipo &lt;strong>Blank App, Packaged (WinUI 3 in Desktop)&lt;/strong>&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-estructura-básica-de-un-paquete-msix">Paso 1: Estructura básica de un paquete MSIX&lt;/h2>
&lt;p>El archivo clave es &lt;code>Package.appxmanifest&lt;/code>, que contiene:&lt;/p>
&lt;ul>
&lt;li>Identidad de la app&lt;/li>
&lt;li>Declaraciones de capacidades&lt;/li>
&lt;li>Asociaciones de archivo, URI, tareas de fondo&lt;/li>
&lt;li>Iconos, entradas al menú inicio, y más&lt;/li>
&lt;/ul>
&lt;p>Ejemplo básico:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Identity&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;com.empresa.miapp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Publisher=&lt;/span>&lt;span class="s">&amp;#34;CN=Empresa&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Version=&lt;/span>&lt;span class="s">&amp;#34;1.0.0.0&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Properties&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;DisplayName&amp;gt;&lt;/span>MiApp&lt;span class="nt">&amp;lt;/DisplayName&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;PublisherDisplayName&amp;gt;&lt;/span>Empresa S.A.&lt;span class="nt">&amp;lt;/PublisherDisplayName&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Logo&amp;gt;&lt;/span>Assets/StoreLogo.png&lt;span class="nt">&amp;lt;/Logo&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Properties&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-2-configurar-iconografía-y-recursos-visuales">Paso 2: Configurar iconografía y recursos visuales&lt;/h2>
&lt;p>Se pueden establecer logos personalizados para:&lt;/p>
&lt;ul>
&lt;li>Barra de tareas&lt;/li>
&lt;li>Menú inicio&lt;/li>
&lt;li>App list (Start Menu)&lt;/li>
&lt;li>Notificaciones toast&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;VisualElements&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">DisplayName=&lt;/span>&lt;span class="s">&amp;#34;MiApp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Square44x44Logo=&lt;/span>&lt;span class="s">&amp;#34;Assets/Icon44.png&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Square150x150Logo=&lt;/span>&lt;span class="s">&amp;#34;Assets/Icon150.png&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Description=&lt;/span>&lt;span class="s">&amp;#34;Aplicación moderna con MSIX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">BackgroundColor=&lt;/span>&lt;span class="s">&amp;#34;transparent&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Los iconos deben estar declarados en todos los tamaños requeridos por el sistema (44, 150, 310, etc.).&lt;/p>
&lt;h2 id="paso-3-agregar-protocolo-personalizado">Paso 3: Agregar protocolo personalizado&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;uap:Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.protocol&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:Protocol&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;miapp&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:DisplayName&amp;gt;&lt;/span>miapp Protocol&lt;span class="nt">&amp;lt;/uap:DisplayName&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:Protocol&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/uap:Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Permite que la app responda a enlaces como &lt;code>miapp://abrir&lt;/code>.&lt;/p>
&lt;h2 id="paso-4-asociar-tipos-de-archivo">Paso 4: Asociar tipos de archivo&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;uap:Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.fileTypeAssociation&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:FileTypeAssociation&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;MiExt&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:SupportedFileTypes&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:FileType&amp;gt;&lt;/span>.miapp&lt;span class="nt">&amp;lt;/uap:FileType&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:SupportedFileTypes&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:DisplayName&amp;gt;&lt;/span>Archivo MiApp&lt;span class="nt">&amp;lt;/uap:DisplayName&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:FileTypeAssociation&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/uap:Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ahora la app podrá abrir estos archivos con doble clic.&lt;/p>
&lt;h2 id="paso-5-declarar-capacidades-del-sistema">Paso 5: Declarar capacidades del sistema&lt;/h2>
&lt;p>Para acceder a funcionalidades como ubicación, micrófono, red, etc.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Capabilities&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Capability&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;internetClient&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Capability&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;location&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:Capability&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;userAccountInformation&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Capabilities&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Siempre declarar solo lo necesario. La declaración excesiva puede generar advertencias o problemas de distribución.&lt;/p>
&lt;h2 id="paso-6-configurar-appexecutionalias">Paso 6: Configurar AppExecutionAlias&lt;/h2>
&lt;p>Esto permite ejecutar la app desde consola:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;uap:Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.appExecutionAlias&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:AppExecutionAlias&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:ExecutionAlias&lt;/span> &lt;span class="na">Alias=&lt;/span>&lt;span class="s">&amp;#34;miapp.exe&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:AppExecutionAlias&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/uap:Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto habilita &lt;code>miapp.exe&lt;/code> en línea de comandos tras instalar la app.&lt;/p>
&lt;h2 id="paso-7-configurar-entrada-al-menú-inicio">Paso 7: Configurar entrada al menú inicio&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Applications&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Application&lt;/span> &lt;span class="na">Id=&lt;/span>&lt;span class="s">&amp;#34;App&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Executable=&lt;/span>&lt;span class="s">&amp;#34;MiApp.exe&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">EntryPoint=&lt;/span>&lt;span class="s">&amp;#34;MiApp.App&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:VisualElements&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">DisplayName=&lt;/span>&lt;span class="s">&amp;#34;MiApp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Square150x150Logo=&lt;/span>&lt;span class="s">&amp;#34;Assets/Logo.png&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">BackgroundColor=&lt;/span>&lt;span class="s">&amp;#34;transparent&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:VisualElements&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/Application&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Applications&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Cada app (o extensión) debe tener su entrada bien declarada.&lt;/p>
&lt;h2 id="paso-8-empaquetar-desde-visual-studio">Paso 8: Empaquetar desde Visual Studio&lt;/h2>
&lt;ol>
&lt;li>Clic derecho sobre el proyecto empaquetado&lt;/li>
&lt;li>Publicar &amp;gt; Crear paquete de la aplicación&lt;/li>
&lt;li>Elegir: &amp;ldquo;Sí, quiero firmar el paquete&amp;rdquo;&lt;/li>
&lt;li>Crear certificado local o usar uno comercial&lt;/li>
&lt;li>Elegir modo Sideloading (para pruebas) o Store&lt;/li>
&lt;/ol>
&lt;p>Esto generará archivos &lt;code>.msix&lt;/code> o &lt;code>.msixbundle&lt;/code> junto con &lt;code>AppInstaller&lt;/code>.&lt;/p>
&lt;h2 id="paso-9-instalar-y-probar-el-paquete">Paso 9: Instalar y probar el paquete&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Add-AppxPackage&lt;/span> &lt;span class="n">-Path&lt;/span> &lt;span class="s2">&amp;#34;.\MiApp.msix&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Verificar en menú inicio, buscar &lt;code>MiApp&lt;/code> y validar comportamiento completo.&lt;/p>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Usar GUID únicos para IDs internos si hay múltiples extensiones&lt;/li>
&lt;li>Revisar el manifiesto en modo XML y no solo visual&lt;/li>
&lt;li>Usar &lt;code>capability declarations&lt;/code> mínimas y revisadas&lt;/li>
&lt;li>Probar el paquete con App Installer antes de distribución&lt;/li>
&lt;li>Mantener la versión del paquete actualizada en cada build&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>El empaquetado con &lt;strong>MSIX&lt;/strong> es esencial para garantizar instalación fiable, comportamiento predecible y compatibilidad con el ecosistema moderno de &lt;strong>Windows&lt;/strong>. El manifiesto ofrece un alto nivel de control sobre cómo se comporta y se expone la aplicación al sistema, permitiendo personalización avanzada, integración con el shell y soporte para flujos de deep linking, archivos, protocolos y más.&lt;/p></description></item><item><title>Creación de ventanas flotantes estilo Widget con posicionamiento persistente en pantalla</title><link>https://cmas.dev/posts/2025-02-21-winui-floating-windows/</link><pubDate>Fri, 21 Feb 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-02-21-winui-floating-windows/</guid><description>&lt;p>Las ventanas flotantes (overlay) son una técnica poderosa para presentar información contextual o utilitaria en una aplicación de escritorio. En el ecosistema moderno de &lt;strong>Windows&lt;/strong>, se pueden implementar como “ventanas tipo Widget” que permanecen siempre visibles, no aparecen en la barra de tareas y mantienen su posición de forma persistente. Este tipo de UI es ideal para herramientas de monitoreo, asistentes, controles rápidos o paneles interactivos.&lt;/p>
&lt;p>Este artículo explica cómo crear este tipo de ventana en una app moderna usando &lt;strong>WinUI 3&lt;/strong> y &lt;strong>Windows App SDK&lt;/strong>, controlando su estilo, posición y comportamiento sin interferir con el foco de otras ventanas del sistema.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Windows 11&lt;/li>
&lt;li>Visual Studio 2022&lt;/li>
&lt;li>Windows App SDK 1.3 o superior&lt;/li>
&lt;li>Proyecto WinUI 3 (Packaged)&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-crear-una-nueva-ventana-tipo-overlay">Paso 1: Crear una nueva ventana tipo overlay&lt;/h2>
&lt;p>Definir una nueva clase de ventana:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span> &lt;span class="kd">sealed&lt;/span> &lt;span class="kd">partial&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">WidgetWindow&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">Window&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">public&lt;/span> &lt;span class="n">WidgetWindow&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">InitializeComponent&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ExtendsContentIntoTitleBar&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetWidgetStyle&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">private&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">SetWidgetStyle&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">hwnd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">WinRT&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Interop&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WindowNative&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetWindowHandle&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">this&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">hwndId&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Microsoft&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">UI&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Win32Interop&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetWindowIdFromWindow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">hwnd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">appWindow&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Microsoft&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">UI&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Windowing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AppWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetFromWindowId&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">hwndId&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">appWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetPresenter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AppWindowPresenterKind&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CompactOverlay&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// modo PiP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">appWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">IsShownInSwitchers&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto crea una ventana pequeña, sin ícono en barra de tareas ni Alt+Tab.&lt;/p>
&lt;h2 id="paso-2-configurar-tamaño-posición-y-transparencia">Paso 2: Configurar tamaño, posición y transparencia&lt;/h2>
&lt;p>En el constructor:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">appWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Resize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">Windows&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Graphics&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SizeInt32&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">Width&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">320&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Height&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">200&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">appWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Move&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">Windows&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Graphics&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PointInt32&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">X&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">1000&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Y&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">60&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">appWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Changed&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="n">AppWindow_Changed&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Persistir posición en &lt;code>AppWindow_Changed&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">private&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">AppWindow_Changed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AppWindow&lt;/span> &lt;span class="n">sender&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">object&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">bounds&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">sender&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Position&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Settings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Default&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WidgetX&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">bounds&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">X&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Settings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Default&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WidgetY&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">bounds&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Settings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Default&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Save&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Leer posición previa al iniciar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">posX&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Settings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Default&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WidgetX&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">posY&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Settings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Default&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WidgetY&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">appWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Move&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">Windows&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Graphics&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PointInt32&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">X&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">posX&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Y&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">posY&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-3-eliminar-marco-y-ajustar-diseño">Paso 3: Eliminar marco y ajustar diseño&lt;/h2>
&lt;p>En XAML:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Border&lt;/span> &lt;span class="na">Background=&lt;/span>&lt;span class="s">&amp;#34;White&amp;#34;&lt;/span> &lt;span class="na">CornerRadius=&lt;/span>&lt;span class="s">&amp;#34;10&amp;#34;&lt;/span> &lt;span class="na">Padding=&lt;/span>&lt;span class="s">&amp;#34;10&amp;#34;&lt;/span> &lt;span class="na">BorderBrush=&lt;/span>&lt;span class="s">&amp;#34;Gray&amp;#34;&lt;/span> &lt;span class="na">BorderThickness=&lt;/span>&lt;span class="s">&amp;#34;1&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;StackPanel&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;TextBlock&lt;/span> &lt;span class="na">Text=&lt;/span>&lt;span class="s">&amp;#34;Estado del sistema&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;ProgressBar&lt;/span> &lt;span class="na">Value=&lt;/span>&lt;span class="s">&amp;#34;70&amp;#34;&lt;/span> &lt;span class="na">Width=&lt;/span>&lt;span class="s">&amp;#34;200&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/StackPanel&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Border&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Eliminar barra de título:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">appWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TitleBar&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ExtendsContentIntoTitleBar&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">appWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TitleBar&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetPreferredHeight&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-4-mostrar-la-ventana-desde-la-app-principal">Paso 4: Mostrar la ventana desde la app principal&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">private&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">MostrarWidget_Click&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">object&lt;/span> &lt;span class="n">sender&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RoutedEventArgs&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">widget&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">WidgetWindow&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">widget&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-5-mantener-siempre-visible-topmost">Paso 5: Mantener siempre visible (topmost)&lt;/h2>
&lt;p>Windows App SDK no expone directamente &lt;code>Topmost&lt;/code>. Usar Win32 interop:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="na">[DllImport(&amp;#34;user32.dll&amp;#34;)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">static&lt;/span> &lt;span class="kd">extern&lt;/span> &lt;span class="kt">bool&lt;/span> &lt;span class="n">SetWindowPos&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">IntPtr&lt;/span> &lt;span class="n">hWnd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span> &lt;span class="n">hWndInsertAfter&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">X&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">Y&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">cy&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint&lt;/span> &lt;span class="n">uFlags&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">SWP_NOSIZE&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">0x0001&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">SWP_NOMOVE&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">0x0002&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">const&lt;/span> &lt;span class="kt">uint&lt;/span> &lt;span class="n">TOPMOST_FLAGS&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">SWP_NOMOVE&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="n">SWP_NOSIZE&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">SetWindowPos&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">hwnd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">(-&lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">TOPMOST_FLAGS&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// HWND_TOPMOST&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto asegura que el widget flote sobre el resto.&lt;/p>
&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Visualizadores de estado de sistema o recursos&lt;/li>
&lt;li>Paneles de control rápido (audio, energía, VPN)&lt;/li>
&lt;li>Asistentes flotantes de accesibilidad o IA&lt;/li>
&lt;li>Lectores de transcripción, traductores o anotadores&lt;/li>
&lt;li>Herramientas para streamers o grabación de pantalla&lt;/li>
&lt;/ul>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Permitir al usuario mover y cerrar la ventana fácilmente&lt;/li>
&lt;li>Guardar posición y tamaño de forma persistente&lt;/li>
&lt;li>No interferir con el foco de otras apps&lt;/li>
&lt;li>Proveer configuración de visibilidad (autoocultar, minimizar)&lt;/li>
&lt;li>No mostrar por defecto sin consentimiento del usuario&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>Con &lt;strong>WinUI 3&lt;/strong> y &lt;strong>Windows App SDK&lt;/strong> es posible crear ventanas flotantes al estilo Widget que extienden la funcionalidad de la app más allá de la ventana principal. Este patrón de UI permite construir experiencias utilitarias, persistentes y altamente accesibles para los usuarios de &lt;strong>Windows 11&lt;/strong>, aprovechando al máximo las capacidades del sistema operativo moderno.&lt;/p></description></item><item><title>Uso de la nueva API de Shared Window Mode para apps multi-ventana en Windows 11</title><link>https://cmas.dev/posts/2025-02-14-winui-shared-window-multi-windows/</link><pubDate>Fri, 14 Feb 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-02-14-winui-shared-window-multi-windows/</guid><description>&lt;p>&lt;strong>Windows 11&lt;/strong> introduce nuevas capacidades para la gestión de ventanas, entre ellas el &lt;strong>Shared Window Mode&lt;/strong>, que permite que las aplicaciones modernas compartan múltiples ventanas como parte de una misma experiencia multitarea. Esta característica mejora el soporte nativo para escenarios como edición paralela, múltiples vistas, comparaciones en paralelo y workflows de aplicaciones productivas.&lt;/p>
&lt;p>En este artículo se explora cómo utilizar esta API desde una aplicación moderna WinUI 3 utilizando &lt;strong>Windows App SDK&lt;/strong>, gestionando múltiples ventanas, compartiéndolas dentro de un contexto común y habilitando integración visual con Snap Layouts y Alt+Tab de forma coherente.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Windows 11 build 22621 o superior&lt;/li>
&lt;li>Visual Studio 2022&lt;/li>
&lt;li>Windows App SDK 1.3+ (preferido 1.4+)&lt;/li>
&lt;li>Proyecto empaquetado (MSIX) con soporte multi-ventana&lt;/li>
&lt;/ul>
&lt;h2 id="fundamento-qué-es-shared-window-mode">Fundamento: ¿qué es Shared Window Mode?&lt;/h2>
&lt;p>Es un modo de presentación que permite agrupar múltiples ventanas dentro del mismo conjunto lógico del sistema operativo. A efectos del usuario, todas las ventanas se tratan como una única aplicación, tanto visualmente como en el sistema de tareas, Snap Layouts y la barra de tareas.&lt;/p>
&lt;h2 id="paso-1-crear-una-ventana-secundaria-en-winui-3">Paso 1: Crear una ventana secundaria en WinUI 3&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span> &lt;span class="kd">sealed&lt;/span> &lt;span class="kd">partial&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">EditorWindow&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">Window&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">public&lt;/span> &lt;span class="n">EditorWindow&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">InitializeComponent&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Title&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Editor Avanzado&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Desde &lt;code>MainWindow.xaml.cs&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">private&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">AbrirNuevaVentana_Click&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">object&lt;/span> &lt;span class="n">sender&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RoutedEventArgs&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">ventana&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">EditorWindow&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ventana&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto crea una segunda ventana independiente.&lt;/p>
&lt;h2 id="paso-2-declarar-el-grupo-de-presentación-compartida">Paso 2: Declarar el grupo de presentación compartida&lt;/h2>
&lt;p>Importar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">Microsoft.UI.Windowing&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">Windows.UI.WindowManagement&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Crear el grupo de ventana compartida:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">presenter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">AppWindowPresenter&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateForContext&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;edicion&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">presenter&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GroupMode&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">AppWindowGroupMode&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Shared&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>A partir de Windows App SDK 1.4, se puede usar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">AppWindowGroup&lt;/span> &lt;span class="k">group&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">AppWindowGroup&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TryCreateAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">group&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AddWindow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">AppWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetFromWindowId&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">windowId&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto agrupa ambas ventanas visualmente.&lt;/p>
&lt;h2 id="paso-3-activar-snap-layouts-compartidos">Paso 3: Activar Snap Layouts compartidos&lt;/h2>
&lt;p>El sistema operativo permite agrupar estas ventanas en Snap Layouts como si fueran parte de una sola app.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">mainAppWindow&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">AppWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetFromWindowId&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">GetWindowIdForWindow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">MainWindow&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">secondaryAppWindow&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">AppWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetFromWindowId&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">GetWindowIdForWindow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EditorWindow&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">await&lt;/span> &lt;span class="n">AppWindowGroup&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateFromAppWindowsAsync&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">mainAppWindow&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">secondaryAppWindow&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto las unifica para minimizar, cerrar, agrupar en la barra de tareas y cambiar con Alt+Tab.&lt;/p>
&lt;h2 id="paso-4-controlar-comportamiento-individual">Paso 4: Controlar comportamiento individual&lt;/h2>
&lt;p>Cada ventana puede mantener sus controles independientes. Por ejemplo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">EditorWindow&lt;/span> &lt;span class="n">editor&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">EditorWindow&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">editor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ExtendsContentIntoTitleBar&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">editor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AppWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetIcon&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Assets/editor.png&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">editor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AppWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Resize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">Windows&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Graphics&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SizeInt32&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">Width&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">800&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Height&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">600&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">editor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-5-comunicación-entre-ventanas">Paso 5: Comunicación entre ventanas&lt;/h2>
&lt;p>Usar &lt;code>static&lt;/code> o eventos para intercambio de datos:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="n">Action&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">&amp;gt;?&lt;/span> &lt;span class="n">OnGuardarNota&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">private&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">Guardar_Click&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">object&lt;/span> &lt;span class="n">sender&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RoutedEventArgs&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">OnGuardarNota&lt;/span>&lt;span class="p">?.&lt;/span>&lt;span class="n">Invoke&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">txtNota&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>En &lt;code>MainWindow&lt;/code>, suscribirse:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">EditorWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">OnGuardarNota&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">nota&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="n">NotasList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">nota&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Aplicaciones con vista de edición y vista previa paralela&lt;/li>
&lt;li>Múltiples documentos (MDI) con organización automática&lt;/li>
&lt;li>Comparación de versiones, código o texto&lt;/li>
&lt;li>Edición por secciones o pestañas separadas&lt;/li>
&lt;/ul>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>No sobrecargar al usuario con muchas ventanas simultáneas&lt;/li>
&lt;li>Dar control claro para cerrar o reabrir ventanas&lt;/li>
&lt;li>Persistir tamaño y posición si es relevante&lt;/li>
&lt;li>Usar iconos y títulos descriptivos para distinguir roles&lt;/li>
&lt;li>Evitar bloquear el hilo principal con la creación de ventanas&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>El &lt;strong>Shared Window Mode&lt;/strong> en &lt;strong>Windows 11&lt;/strong> permite ofrecer una experiencia de usuario verdaderamente multitarea y flexible en apps modernas. Esta capacidad, combinada con &lt;strong>WinUI 3&lt;/strong> y &lt;strong>Windows App SDK&lt;/strong>, habilita escenarios productivos, colaborativos y visuales que antes requerían soluciones complejas. Gracias a su integración con &lt;em>AppWindowGroup&lt;/em> y &lt;em>Snap Layouts&lt;/em>, las apps modernas pueden comportarse como verdaderos entornos profesionales de trabajo múltiple.&lt;/p></description></item><item><title>Deep linking entre apps modernas y el sistema</title><link>https://cmas.dev/posts/2025-02-07-winui-deep-linking/</link><pubDate>Fri, 07 Feb 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-02-07-winui-deep-linking/</guid><description>&lt;p>Una de las características más poderosas de &lt;strong>Windows App SDK&lt;/strong> es su capacidad para integrar aplicaciones modernas con el sistema operativo a través de mecanismos como &lt;strong>URI scheme handlers&lt;/strong> y &lt;strong>asociaciones de tipos de archivo&lt;/strong>. Esta integración permite a las apps &lt;strong>WinUI 3&lt;/strong> ser invocadas desde otras apps, scripts, accesos directos o enlaces web, facilitando flujos interconectados, automatización y mejores experiencias de usuario.&lt;/p>
&lt;p>En este artículo se aborda cómo habilitar el deep linking en aplicaciones modernas, tanto desde URI personalizados como desde archivos con extensiones registradas. Se incluyen ejemplos prácticos, manejo de activación, y recomendaciones de seguridad y diseño.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Proyecto WinUI 3 empaquetado (MSIX) con Windows App SDK&lt;/li>
&lt;li>SDK mínimo: Windows 10 build 19041&lt;/li>
&lt;li>Acceso a &lt;code>Package.appxmanifest&lt;/code> en modo texto&lt;/li>
&lt;li>Conocimientos de activación y flujo de arranque en WinUI 3&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-registrar-esquema-uri-personalizado">Paso 1: Registrar esquema URI personalizado&lt;/h2>
&lt;p>Abrir &lt;code>Package.appxmanifest&lt;/code> y agregar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.protocol&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:Protocol&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;miapp&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:DisplayName&amp;gt;&lt;/span>Mi App URI Handler&lt;span class="nt">&amp;lt;/uap:DisplayName&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:Protocol&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto permite que el sistema asocie &lt;code>miapp://&lt;/code> con tu aplicación.&lt;/p>
&lt;h2 id="paso-2-manejar-la-activación-uri">Paso 2: Manejar la activación URI&lt;/h2>
&lt;p>En &lt;code>App.xaml.cs&lt;/code>, implementar &lt;code>OnActivated&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">protected&lt;/span> &lt;span class="kd">override&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">OnActivated&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">IActivatedEventArgs&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">args&lt;/span> &lt;span class="k">is&lt;/span> &lt;span class="n">ProtocolActivatedEventArgs&lt;/span> &lt;span class="n">protocolArgs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">uri&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">protocolArgs&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Uri&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">action&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">uri&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Host&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">action&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;abrirpanel&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">PanelWindow&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">action&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;detalle&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">id&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">uri&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParsed&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetFirstValueByName&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;id&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">DetalleWindow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ejemplo de enlace que abriría la app:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">miapp://abrirpanel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">miapp://detalle?id=456
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Estos enlaces pueden usarse desde PowerShell, scripts, HTML o accesos directos.&lt;/p>
&lt;h2 id="paso-3-crear-acceso-directo-con-uri">Paso 3: Crear acceso directo con URI&lt;/h2>
&lt;p>Crear &lt;code>.url&lt;/code> o acceso directo con destino:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">miapp://abrirpanel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>También es posible crear enlaces desde otras apps:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;miapp://abrirpanel&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>Abrir Panel&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-4-registrar-tipo-de-archivo-personalizado">Paso 4: Registrar tipo de archivo personalizado&lt;/h2>
&lt;p>En el manifiesto:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;uap:Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.fileTypeAssociation&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:FileTypeAssociation&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;miformato&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:SupportedFileTypes&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:FileType&amp;gt;&lt;/span>.mif&lt;span class="nt">&amp;lt;/uap:FileType&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:SupportedFileTypes&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:DisplayName&amp;gt;&lt;/span>Archivo personalizado&lt;span class="nt">&amp;lt;/uap:DisplayName&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:FileTypeAssociation&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/uap:Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto indica al sistema que tu app puede manejar archivos &lt;code>.mif&lt;/code>.&lt;/p>
&lt;h2 id="paso-5-manejar-apertura-de-archivos">Paso 5: Manejar apertura de archivos&lt;/h2>
&lt;p>Modificar &lt;code>OnFileActivated&lt;/code> en &lt;code>App.xaml.cs&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">protected&lt;/span> &lt;span class="kd">override&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">OnFileActivated&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">FileActivatedEventArgs&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Files&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">StorageFile&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">FileViewerWindow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto permite que el usuario abra el archivo &lt;code>.mif&lt;/code> con doble clic desde el Explorador de Windows o desde línea de comandos.&lt;/p>
&lt;h2 id="paso-6-probar-invocación-desde-sistema">Paso 6: Probar invocación desde sistema&lt;/h2>
&lt;p>En PowerShell:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Start-Process&lt;/span> &lt;span class="s2">&amp;#34;miapp://detalle?id=123&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para probar apertura de archivo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Start-Process&lt;/span> &lt;span class="s2">&amp;#34;C:\archivos\ejemplo.mif&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Verificar que se abra tu app con la UI adecuada.&lt;/p>
&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Invocar flujos internos de la app desde navegador o email&lt;/li>
&lt;li>Procesar archivos personalizados desde el explorador&lt;/li>
&lt;li>Integración entre apps de escritorio (ej. app CRM que abre visor externo)&lt;/li>
&lt;li>Automatización de tareas con URI para accesos rápidos&lt;/li>
&lt;li>Generar archivos &lt;code>.mif&lt;/code> desde otra app para abrirlos con tu app&lt;/li>
&lt;/ul>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Validar todos los parámetros recibidos vía URI para evitar inyección o ejecución no deseada&lt;/li>
&lt;li>No ejecutar automáticamente acciones peligrosas sin confirmación&lt;/li>
&lt;li>Documentar los URI soportados si se espera que otros sistemas los usen&lt;/li>
&lt;li>Mostrar mensajes útiles si la invocación está incompleta&lt;/li>
&lt;li>Versionar los esquemas y mantener compatibilidad hacia atrás si evolucionan&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>El soporte para esquemas URI personalizados y asociaciones de tipos de archivo en &lt;strong>Windows App SDK&lt;/strong> permite construir aplicaciones modernas que se integran profundamente con el sistema operativo, ofreciendo flujos más naturales y funcionales. Esta capacidad amplía el alcance y conectividad de una app, facilitando su uso en entornos automatizados, interoperables o colaborativos.&lt;/p></description></item><item><title>Implementación de Widgets personalizados para Windows 11 desde una app moderna</title><link>https://cmas.dev/posts/2025-01-31-winui-widget-windows11/</link><pubDate>Fri, 31 Jan 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-01-31-winui-widget-windows11/</guid><description>&lt;p>&lt;strong>Windows 11&lt;/strong> ha reintroducido el concepto de widgets como parte central de su experiencia de usuario, permitiendo a las aplicaciones modernas integrar contenido interactivo directamente en el panel de Widgets. Con la reciente apertura del canal de desarrollo de widgets para terceros, los desarrolladores pueden crear experiencias ligeras, contextuales y persistentes ancladas al sistema operativo, todo desde una aplicación moderna basada en Windows App SDK.&lt;/p>
&lt;p>Este artículo detalla paso a paso cómo estructurar, registrar y mostrar un widget personalizado en Windows 11, partiendo de una aplicación moderna &lt;strong>WinUI 3&lt;/strong> empaquetada. Se incluye la configuración del manifiesto, diseño visual y manejo de datos dinámicos.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Windows 11 22H2 (Build 22621+) o superior&lt;/li>
&lt;li>Visual Studio 2022 actualizado&lt;/li>
&lt;li>Windows App SDK 1.3 o superior&lt;/li>
&lt;li>Proyecto Packaged (MSIX)&lt;/li>
&lt;li>Microsoft Store para habilitar canal de publicación del widget&lt;/li>
&lt;li>Cuenta de desarrollador registrada&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-entender-el-modelo-de-widgets">Paso 1: Entender el modelo de Widgets&lt;/h2>
&lt;p>Los widgets de Windows 11 están construidos como una extensión de la app principal. Técnicamente son controles WebView2 renderizados como tarjetas, que viven en un host de sistema y son impulsados por Adaptive Cards o contenido HTML.&lt;/p>
&lt;p>La integración se realiza a través de un manifiesto especial &lt;code>WidgetsManifest.xml&lt;/code> y archivos de configuración complementarios.&lt;/p>
&lt;h2 id="paso-2-crear-el-paquete-del-widget">Paso 2: Crear el paquete del widget&lt;/h2>
&lt;p>Estructura típica:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">MyApp/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── App.xaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── MainWindow.xaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── Widgets/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── myWidget/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── index.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── widget.json
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── logo.png
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── WidgetsManifest.xml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>El archivo &lt;code>widget.json&lt;/code> define el contenido del widget:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;title&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Resumen diario&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;description&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Muestra tareas, clima y calendario&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;hostedAppId&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;MyAppWidget&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;image&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;logo.png&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;defaultSize&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;medium&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;content&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;type&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;webview&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;url&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;ms-appx-web:///Widgets/myWidget/index.html&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>index.html&lt;/code> contiene el contenido visible:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">head&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">meta&lt;/span> &lt;span class="na">charset&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;UTF-8&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">head&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">h1&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>Mi widget&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">h1&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>Bienvenido, usuario&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-3-crear-widgetsmanifestxml">Paso 3: Crear WidgetsManifest.xml&lt;/h2>
&lt;p>Este manifiesto registra los widgets para la app:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;WidgetManifest&lt;/span> &lt;span class="na">xmlns=&lt;/span>&lt;span class="s">&amp;#34;http://schemas.microsoft.com/appx/2022/widgetmanifest&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;HostAppId&amp;gt;&lt;/span>MyAppWidget&lt;span class="nt">&amp;lt;/HostAppId&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Widgets&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Widget&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Id&amp;gt;&lt;/span>widget.resumen&lt;span class="nt">&amp;lt;/Id&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Path&amp;gt;&lt;/span>ms-appx-web:///Widgets/myWidget/widget.json&lt;span class="nt">&amp;lt;/Path&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/Widget&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/Widgets&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/WidgetManifest&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Este archivo se incluye en el empaquetado MSIX.&lt;/p>
&lt;h2 id="paso-4-configurar-el-manifiesto-msix">Paso 4: Configurar el manifiesto MSIX&lt;/h2>
&lt;p>Editar &lt;code>Package.appxmanifest&lt;/code> y agregar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.widget&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Widget&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;ManifestPath&amp;gt;&lt;/span>ms-appx:///WidgetsManifest.xml&lt;span class="nt">&amp;lt;/ManifestPath&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/Widget&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto indica que la app soporta widgets y dónde encontrar su configuración.&lt;/p>
&lt;h2 id="paso-5-publicar-e-instalar">Paso 5: Publicar e instalar&lt;/h2>
&lt;p>Actualmente, los widgets solo se activan para apps publicadas o en canal Insider con habilitación por parte de Microsoft. Para pruebas:&lt;/p>
&lt;ul>
&lt;li>Enviar a canal privado de Microsoft Store&lt;/li>
&lt;li>Solicitar habilitación del widget en tu cuenta desarrollador&lt;/li>
&lt;li>Instalar con &lt;code>Add-AppxPackage&lt;/code> local + flags de prueba de widgets&lt;/li>
&lt;/ul>
&lt;h2 id="paso-6-comunicación-entre-app-y-widget">Paso 6: Comunicación entre app y widget&lt;/h2>
&lt;p>Los widgets pueden enviar mensajes al proceso principal usando WebView2 o protocolos internos:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">window&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">chrome&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">webview&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">postMessage&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;abrirApp&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Y desde la app:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">WebView&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CoreWebView2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WebMessageReceived&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">mensaje&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TryGetWebMessageAsString&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">mensaje&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;abrirApp&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">App&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ShowMainWindow&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto permite que el widget lance secciones de la app o actualice información.&lt;/p>
&lt;h2 id="paso-7-actualización-de-datos-dinámica">Paso 7: Actualización de datos dinámica&lt;/h2>
&lt;p>Los widgets pueden obtener datos dinámicamente:&lt;/p>
&lt;ul>
&lt;li>Desde &lt;code>localStorage&lt;/code> o APIs JS&lt;/li>
&lt;li>Desde URI internas (ej. REST desde localhost)&lt;/li>
&lt;li>Desde la app principal usando canal de comunicación&lt;/li>
&lt;/ul>
&lt;p>Por ejemplo, un widget de clima puede actualizar su contenido vía JavaScript cada 10 minutos.&lt;/p>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Mantener el contenido mínimo y legible&lt;/li>
&lt;li>No sobrecargar visualmente el widget&lt;/li>
&lt;li>Usar Adaptive Cards o HTML accesible&lt;/li>
&lt;li>Probar en múltiples resoluciones (small, medium, large)&lt;/li>
&lt;li>Permitir configuración desde la app principal&lt;/li>
&lt;/ul>
&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Widgets de calendario, clima, tareas, actividad&lt;/li>
&lt;li>Panel de control para apps de productividad&lt;/li>
&lt;li>Resumen de salud del sistema o estadísticas personales&lt;/li>
&lt;li>Entrada rápida de datos (notas, eventos)&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>La posibilidad de implementar widgets personalizados en &lt;strong>Windows 11&lt;/strong> abre nuevas puertas para la visibilidad, productividad e integración del usuario con una aplicación. Los widgets son ligeros, contextuales y permanecen visibles más allá del tiempo de ejecución de la app, reforzando su utilidad y presencia diaria. Gracias a &lt;strong>Windows App SDK&lt;/strong>, su implementación desde apps modernas es posible, estructurada y alineada con las mejores prácticas de experiencia de usuario en el ecosistema &lt;strong>Windows&lt;/strong> moderno.&lt;/p></description></item><item><title>Interacción con el portapapeles del sistema usando Windows.ApplicationModel.DataTransfer</title><link>https://cmas.dev/posts/2025-01-24-winui-clipboard-interaction/</link><pubDate>Fri, 24 Jan 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-01-24-winui-clipboard-interaction/</guid><description>&lt;p>El portapapeles es una funcionalidad crítica para la experiencia del usuario en &lt;strong>Windows&lt;/strong>. Permite copiar y pegar texto, imágenes, URIs y otros datos entre aplicaciones. En las apps modernas desarrolladas con &lt;strong>WinUI 3&lt;/strong> y &lt;strong>Windows App SDK&lt;/strong>, se puede interactuar programáticamente con el portapapeles del sistema para mejorar la productividad, ofrecer funcionalidades avanzadas y controlar la experiencia de transferencia de contenido.&lt;/p>
&lt;p>Este artículo explica paso a paso cómo acceder, escribir y leer del portapapeles en aplicaciones modernas, así como técnicas para escuchar cambios en su contenido, realizar transformaciones y trabajar con múltiples formatos.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Proyecto WinUI 3 empaquetado con Windows App SDK&lt;/li>
&lt;li>SDK mínimo: Windows 10 19041+&lt;/li>
&lt;li>Namespace clave: &lt;code>Windows.ApplicationModel.DataTransfer&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="escribir-texto-en-el-portapapeles">Escribir texto en el portapapeles&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">Windows.ApplicationModel.DataTransfer&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">dataPackage&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">DataPackage&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dataPackage&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Texto copiado desde mi app WinUI 3&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Clipboard&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetContent&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dataPackage&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>También se puede agregar metadatos:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">dataPackage&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Properties&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Title&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Título de contenido&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dataPackage&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Properties&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Description&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Descripción opcional&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para notificar explícitamente al sistema:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Clipboard&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Flush&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="leer-texto-del-portapapeles">Leer texto del portapapeles&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">dataView&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Clipboard&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetContent&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">dataView&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StandardDataFormats&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">string&lt;/span> &lt;span class="n">texto&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">dataView&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetTextAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ClipboardOutput&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;Contenido: {texto}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Este método se puede invocar desde un botón o temporizador.&lt;/p>
&lt;h2 id="soporte-para-otros-formatos">Soporte para otros formatos&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">dataPackage&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetUri&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">Uri&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;https://ejemplo.com&amp;#34;&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dataPackage&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetHtmlFormat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;b&amp;gt;HTML&amp;lt;/b&amp;gt; con formato&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dataPackage&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetBitmap&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">RandomAccessStreamReference&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateFromUri&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">Uri&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ms-appx:///Assets/logo.png&amp;#34;&lt;/span>&lt;span class="p">)));&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Verificar formatos disponibles:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">formats&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">dataView&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AvailableFormats&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="detectar-cambios-en-el-portapapeles">Detectar cambios en el portapapeles&lt;/h2>
&lt;p>No hay un evento oficial en &lt;code>Clipboard&lt;/code>, pero se puede implementar polling:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">DispatcherQueueTimer&lt;/span> &lt;span class="n">timer&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">DispatcherQueue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateTimer&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">string&lt;/span> &lt;span class="n">ultimoTexto&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">timer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Interval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">TimeSpan&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">FromSeconds&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">timer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Tick&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="kd">async&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">contenido&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Clipboard&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetContent&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">contenido&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StandardDataFormats&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">actual&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">contenido&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetTextAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">actual&lt;/span> &lt;span class="p">!=&lt;/span> &lt;span class="n">ultimoTexto&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ultimoTexto&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">actual&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ClipboardOutput&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;Nuevo texto: {actual}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">timer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Start&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto permite detectar cuando el usuario copia nuevo contenido desde otra app.&lt;/p>
&lt;h2 id="restringir-formatos-permitidos">Restringir formatos permitidos&lt;/h2>
&lt;p>Para seguridad o control de flujo, verificar antes de aceptar contenido:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">dataView&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StandardDataFormats&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">!&lt;/span>&lt;span class="n">dataView&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StandardDataFormats&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Html&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Solo texto plano permitido&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="copiar-contenido-personalizado-json-archivos">Copiar contenido personalizado (JSON, archivos)&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">dataPackage&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetData&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;custom/json&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">jsonString&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Nota: se necesita compatibilidad en la app que reciba ese contenido para leer formatos personalizados.&lt;/p>
&lt;h2 id="ejemplo-de-uso-completo-en-ui">Ejemplo de uso completo en UI&lt;/h2>
&lt;p>XAML:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;StackPanel&lt;/span> &lt;span class="na">Padding=&lt;/span>&lt;span class="s">&amp;#34;20&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;TextBox&lt;/span> &lt;span class="na">x:Name=&lt;/span>&lt;span class="s">&amp;#34;ClipboardInput&amp;#34;&lt;/span> &lt;span class="na">Header=&lt;/span>&lt;span class="s">&amp;#34;Texto a copiar&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Button&lt;/span> &lt;span class="na">Content=&lt;/span>&lt;span class="s">&amp;#34;Copiar al portapapeles&amp;#34;&lt;/span> &lt;span class="na">Click=&lt;/span>&lt;span class="s">&amp;#34;Copiar_Click&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Button&lt;/span> &lt;span class="na">Content=&lt;/span>&lt;span class="s">&amp;#34;Leer portapapeles&amp;#34;&lt;/span> &lt;span class="na">Click=&lt;/span>&lt;span class="s">&amp;#34;Leer_Click&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;TextBlock&lt;/span> &lt;span class="na">x:Name=&lt;/span>&lt;span class="s">&amp;#34;ClipboardOutput&amp;#34;&lt;/span> &lt;span class="na">TextWrapping=&lt;/span>&lt;span class="s">&amp;#34;Wrap&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/StackPanel&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Code-behind:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">private&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">Copiar_Click&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">object&lt;/span> &lt;span class="n">sender&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RoutedEventArgs&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">data&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">DataPackage&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ClipboardInput&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Clipboard&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SetContent&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ClipboardOutput&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Copiado.&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">private&lt;/span> &lt;span class="kd">async&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">Leer_Click&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">object&lt;/span> &lt;span class="n">sender&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">RoutedEventArgs&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">contenido&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Clipboard&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetContent&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">contenido&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StandardDataFormats&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">texto&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">contenido&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetTextAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ClipboardOutput&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;Leído: {texto}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Pegar contenido enriquecido en editores (markdown, HTML)&lt;/li>
&lt;li>Copiar información contextual como tokens, ID o URIs&lt;/li>
&lt;li>Integrar con “Copiar imagen” o “Copiar como JSON”&lt;/li>
&lt;li>Composición de snippets o macros desde múltiples fuentes&lt;/li>
&lt;li>Interacción fluida entre apps modernas y legacy&lt;/li>
&lt;/ul>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Siempre verificar que el contenido exista antes de leer&lt;/li>
&lt;li>No sobrescribir el portapapeles sin notificar al usuario&lt;/li>
&lt;li>Usar &lt;code>Clipboard.Clear()&lt;/code> solo si estrictamente necesario&lt;/li>
&lt;li>Adaptar al formato correcto según destino (no forzar HTML si no se soporta)&lt;/li>
&lt;li>Considerar privacidad al manipular datos sensibles&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>El acceso al portapapeles del sistema desde &lt;strong>WinUI 3&lt;/strong> permite a las apps modernas integrarse de forma directa con el flujo de trabajo del usuario. Esta capacidad desbloquea múltiples escenarios avanzados como composición de datos, interoperabilidad entre apps, lectura de contenido contextual y productividad mejorada. Gracias a Windows App SDK, estas operaciones son seguras, versátiles y completamente compatibles con el sistema operativo.&lt;/p></description></item><item><title>Consumo de información del sistema desde WinUI 3</title><link>https://cmas.dev/posts/2025-01-17-winui-system-information/</link><pubDate>Fri, 17 Jan 2025 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2025-01-17-winui-system-information/</guid><description>&lt;p>Una aplicación moderna que corre sobre Windows no tiene por qué operar de manera aislada. Gracias a las APIs del sistema operativo disponibles en &lt;strong>Windows App SDK&lt;/strong>, es posible acceder a múltiples fuentes de información contextual del sistema como el estado de la batería, conectividad de red, nivel de volumen y hasta el estado de energía. Esto permite que una app se adapte dinámicamente al entorno del usuario, optimizando la experiencia, reduciendo consumo o informando condiciones especiales.&lt;/p>
&lt;p>En este artículo se muestra cómo consumir información clave del sistema desde una app &lt;strong>WinUI 3&lt;/strong> usando C#, incluyendo suscriptores a eventos para obtener actualizaciones en tiempo real.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Proyecto WinUI 3 Packaged con Windows App SDK&lt;/li>
&lt;li>Visual Studio 2022+&lt;/li>
&lt;li>SDK mínimo 10.0.18362&lt;/li>
&lt;li>Namespaces usados:
&lt;ul>
&lt;li>&lt;code>Windows.System.Power&lt;/code>&lt;/li>
&lt;li>&lt;code>Windows.Networking.Connectivity&lt;/code>&lt;/li>
&lt;li>&lt;code>Windows.Media.Devices&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="batería-estado-y-nivel-de-carga">Batería: estado y nivel de carga&lt;/h2>
&lt;p>Primero, importar el espacio de nombres:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">Windows.System.Power&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Obtener el estado actual:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">level&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">PowerManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RemainingChargePercent&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">state&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">PowerManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">EnergySaverStatus&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Suscribirse a cambios:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">PowerManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RemainingChargePercentChanged&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">updatedLevel&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">PowerManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RemainingChargePercent&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DispatcherQueue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TryEnqueue&lt;/span>&lt;span class="p">(()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">BatteryText&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;Batería: {updatedLevel}%&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="red-conectividad-y-tipo-de-conexión">Red: conectividad y tipo de conexión&lt;/h2>
&lt;p>Importar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">Windows.Networking.Connectivity&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Obtener el perfil actual:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">profile&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">NetworkInformation&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetInternetConnectionProfile&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="n">isConnected&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">profile&lt;/span>&lt;span class="p">?.&lt;/span>&lt;span class="n">GetNetworkConnectivityLevel&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="n">NetworkConnectivityLevel&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">InternetAccess&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">string&lt;/span> &lt;span class="n">interfaceType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">profile&lt;/span>&lt;span class="p">?.&lt;/span>&lt;span class="n">NetworkAdapter&lt;/span>&lt;span class="p">?.&lt;/span>&lt;span class="n">IanaInterfaceType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ToString&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ejemplo de monitoreo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">NetworkInformation&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">NetworkStatusChanged&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">current&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">NetworkInformation&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetInternetConnectionProfile&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">status&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">current&lt;/span>&lt;span class="p">?.&lt;/span>&lt;span class="n">GetNetworkConnectivityLevel&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DispatcherQueue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TryEnqueue&lt;/span>&lt;span class="p">(()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">NetworkText&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;Conectado: {status}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="volumen-nivel-actual-del-sistema">Volumen: nivel actual del sistema&lt;/h2>
&lt;p>Importar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">Windows.Media.Devices&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Obtener el volumen de salida:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">volumeLevel&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">AudioEndpointVolume&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetVolume&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Nota: el acceso directo al volumen del sistema puede requerir componentes COM o APIs Win32 mediante &lt;code>CoreAudioAPI&lt;/code>. Alternativa:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">audioManager&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">MediaDevice&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetAudioRenderSelector&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para actualizaciones en tiempo real, usar WinRT interop o bibliotecas externas como NAudio.&lt;/p>
&lt;h2 id="estado-de-energía-enchufado-o-batería">Estado de energía: enchufado o batería&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">status&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">PowerManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PowerSupplyStatus&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Opciones posibles:&lt;/p>
&lt;ul>
&lt;li>&lt;code>PowerSupplyStatus.Inadequate&lt;/code>&lt;/li>
&lt;li>&lt;code>PowerSupplyStatus.Adequate&lt;/code>&lt;/li>
&lt;li>&lt;code>PowerSupplyStatus.NotPresent&lt;/code>&lt;/li>
&lt;li>&lt;code>PowerSupplyStatus.Unknown&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Ejemplo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">PowerManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PowerSupplyStatusChanged&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">pluggedIn&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">PowerManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PowerSupplyStatus&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DispatcherQueue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TryEnqueue&lt;/span>&lt;span class="p">(()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">StatusText&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Text&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">$&amp;#34;Fuente de energía: {pluggedIn}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="integración-ui">Integración UI&lt;/h2>
&lt;p>En &lt;code>MainWindow.xaml&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;StackPanel&lt;/span> &lt;span class="na">Spacing=&lt;/span>&lt;span class="s">&amp;#34;10&amp;#34;&lt;/span> &lt;span class="na">Padding=&lt;/span>&lt;span class="s">&amp;#34;20&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;TextBlock&lt;/span> &lt;span class="na">x:Name=&lt;/span>&lt;span class="s">&amp;#34;BatteryText&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;TextBlock&lt;/span> &lt;span class="na">x:Name=&lt;/span>&lt;span class="s">&amp;#34;NetworkText&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;TextBlock&lt;/span> &lt;span class="na">x:Name=&lt;/span>&lt;span class="s">&amp;#34;StatusText&amp;#34;&lt;/span>&lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/StackPanel&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>En el constructor, inicializar datos actuales + suscripciones.&lt;/p>
&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Modo ahorro de batería automático cuando baja del 20%&lt;/li>
&lt;li>Advertencia de red metered o limitada (para evitar descargas)&lt;/li>
&lt;li>Reducción de recursos gráficos cuando no hay energía alterna&lt;/li>
&lt;li>Silenciar notificaciones o sonidos si el volumen es 0&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>Las apps modernas en &lt;strong>Windows&lt;/strong> pueden y deben responder al contexto del sistema operativo. Acceder a información como batería, conectividad, energía o audio permite desarrollar aplicaciones adaptativas, eficientes y conscientes del entorno. &lt;strong>WinUI 3&lt;/strong> permite hacerlo de forma natural, segura y en tiempo real gracias a los eventos y APIs disponibles a través de &lt;strong>Windows App SDK&lt;/strong>.&lt;/p></description></item><item><title>Uso avanzado de la Jump List API para apps modernas</title><link>https://cmas.dev/posts/2024-12-27-win-jump-list/</link><pubDate>Fri, 27 Dec 2024 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2024-12-27-win-jump-list/</guid><description>&lt;p>Las &lt;em>Jump Lists&lt;/em> en &lt;strong>Windows&lt;/strong> son menús contextuales que aparecen cuando el usuario hace clic derecho sobre el icono de una aplicación anclada a la barra de tareas o en el menú de inicio. Estas listas permiten exponer accesos directos a tareas frecuentes o específicas dentro de la aplicación, mejorando la accesibilidad, productividad y personalización de la experiencia de usuario.&lt;/p>
&lt;p>Con &lt;strong>Windows App SDK&lt;/strong> y &lt;strong>WinUI 3&lt;/strong>, las apps modernas pueden crear y actualizar Jump Lists de forma dinámica, segmentarlas por grupos, incluir acciones personalizadas y manejar parámetros que activen flujos específicos al iniciarse la app.&lt;/p>
&lt;p>Este artículo describe paso a paso cómo implementar Jump Lists avanzadas con categorías, argumentos, iconos y comportamiento personalizado en apps &lt;strong>WinUI 3&lt;/strong> empaquetadas.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Windows 11&lt;/li>
&lt;li>Visual Studio 2022 o superior&lt;/li>
&lt;li>Proyecto WinUI 3 (packaged) con Windows App SDK&lt;/li>
&lt;li>SDK mínimo: Windows 10 1903 (10.0.18362) o superior&lt;/li>
&lt;li>Referencia a &lt;code>Windows.UI.StartScreen&lt;/code> y &lt;code>Windows.Foundation.Collections&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-verificar-soporte-de-jump-list">Paso 1: Verificar soporte de Jump List&lt;/h2>
&lt;p>Antes de cualquier operación, se debe verificar si la funcionalidad está habilitada en el sistema del usuario:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="n">isSupported&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">JumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">IsSupportedAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">(!&lt;/span>&lt;span class="n">isSupported&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Mostrar mensaje o fallback&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-2-crear-una-jump-list-básica">Paso 2: Crear una Jump List básica&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">jumpList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">JumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">LoadCurrentAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Clear&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">item&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">JumpListItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateWithArguments&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;abrirPanel&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Panel de control&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">item&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Description&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Abrir el panel principal de la app&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">item&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Logo&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Uri&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ms-appx:///Assets/panel.png&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">await&lt;/span> &lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SaveAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Este ejemplo muestra cómo crear un acceso directo que aparecerá al hacer clic derecho en la app anclada.&lt;/p>
&lt;h2 id="paso-3-crear-múltiples-categorías-grupos">Paso 3: Crear múltiples categorías (grupos)&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">JumpListItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateSeparator&lt;/span>&lt;span class="p">());&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">item1&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">JumpListItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateWithArguments&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;modoLectura&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Abrir en modo lectura&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">item1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GroupName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Modos de inicio&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">item2&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">JumpListItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateWithArguments&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;modoEdicion&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Abrir en modo edición&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">item2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GroupName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Modos de inicio&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">await&lt;/span> &lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SaveAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Los elementos con el mismo &lt;code>GroupName&lt;/code> aparecerán agrupados bajo ese título.&lt;/p>
&lt;h2 id="paso-4-manejar-los-argumentos-en-el-arranque">Paso 4: Manejar los argumentos en el arranque&lt;/h2>
&lt;p>En &lt;code>App.xaml.cs&lt;/code>, sobrescribir &lt;code>OnLaunched&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">protected&lt;/span> &lt;span class="kd">override&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">OnLaunched&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Microsoft&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">UI&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Xaml&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">LaunchActivatedEventArgs&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">arguments&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Arguments&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">arguments&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;modoLectura&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">ReaderWindow&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">arguments&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;modoEdicion&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">EditorWindow&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">arguments&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;abrirPanel&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">PanelWindow&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">m_window&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">MainWindow&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">m_window&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto permite que cada acceso directo ejecute una función distinta de la app.&lt;/p>
&lt;h2 id="paso-5-añadir-iconos-personalizados">Paso 5: Añadir iconos personalizados&lt;/h2>
&lt;p>Los íconos de cada elemento deben estar en formato &lt;code>.png&lt;/code> dentro del paquete MSIX (por ejemplo, en &lt;code>/Assets&lt;/code>).&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">item&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Logo&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Uri&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ms-appx:///Assets/lectura.png&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Tamaño recomendado: 32x32 o 64x64. Asegurarse de que estén incluidos en el proyecto como contenido con &amp;ldquo;Copy if newer&amp;rdquo;.&lt;/p>
&lt;h2 id="paso-6-añadir-separadores-visuales">Paso 6: Añadir separadores visuales&lt;/h2>
&lt;p>Para mejorar la jerarquía, usar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">JumpListItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateSeparator&lt;/span>&lt;span class="p">());&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto crea una línea de separación visual entre grupos o categorías.&lt;/p>
&lt;h2 id="paso-7-actualización-dinámica-de-la-jump-list">Paso 7: Actualización dinámica de la Jump List&lt;/h2>
&lt;p>Las Jump Lists pueden ser actualizadas dinámicamente según el estado del usuario, datos recientes, documentos o permisos:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">usuarioEsAdmin&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">adminItem&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">JumpListItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateWithArguments&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;panelAdmin&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Panel de administración&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">adminItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GroupName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Herramientas&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">adminItem&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Después de modificar, recordar guardar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">await&lt;/span> &lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SaveAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-8-limpiar-o-resetear-la-jump-list">Paso 8: Limpiar o resetear la Jump List&lt;/h2>
&lt;p>En algunos escenarios (cerrar sesión, cambiar de perfil), es útil limpiar:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">jumpList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">JumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">LoadCurrentAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Clear&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">await&lt;/span> &lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SaveAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto garantiza que no haya entradas obsoletas.&lt;/p>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Usar textos cortos y descripciones claras&lt;/li>
&lt;li>Limitar la lista a 5–7 accesos para no sobrecargar&lt;/li>
&lt;li>Organizar por contexto (modos, herramientas, recientes)&lt;/li>
&lt;li>Evitar agregar funciones no disponibles para el usuario actual&lt;/li>
&lt;li>Actualizar en tiempo de ejecución si cambia el contexto del usuario&lt;/li>
&lt;/ul>
&lt;h2 id="casos-de-uso-reales">Casos de uso reales&lt;/h2>
&lt;ul>
&lt;li>Acceder directamente a secciones internas de una app (informes, configuración, contactos)&lt;/li>
&lt;li>Iniciar flujos especiales (cámara, escaneo, captura, conexión)&lt;/li>
&lt;li>Abrir documentos recientes o plantillas específicas&lt;/li>
&lt;li>Exponer acciones administrativas para perfiles con privilegios&lt;/li>
&lt;li>Soporte para herramientas multitarea sin cambiar ventana principal&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>La &lt;em>Jump List API&lt;/em> permite a las aplicaciones modernas &lt;strong>WinUI 3&lt;/strong> integrarse profundamente con la experiencia del escritorio en &lt;strong>Windows&lt;/strong>, ofreciendo accesos directos contextualizados, útiles y adaptables. Esta funcionalidad mejora la interacción del usuario con la aplicación y refuerza su presencia en el sistema operativo, permitiendo flujos más rápidos y naturales desde la barra de tareas o el menú inicio.&lt;/p>
&lt;p>A través de argumentos, iconos, agrupaciones y lógica condicional, las Jump Lists pueden convertirse en una poderosa extensión de la experiencia del usuario para cualquier aplicación moderna en &lt;strong>Windows&lt;/strong>.&lt;/p></description></item><item><title>Integración con la API de notificaciones nativas</title><link>https://cmas.dev/posts/2024-12-20-notification-api-integration/</link><pubDate>Fri, 20 Dec 2024 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2024-12-20-notification-api-integration/</guid><description>&lt;p>Las notificaciones del sistema son uno de los mecanismos más eficaces para comunicar información al usuario sin interrumpir su flujo de trabajo. En &lt;strong>Windows&lt;/strong>, estas notificaciones pueden ser enriquecidas mediante el sistema de notificaciones nativas, que incluye soporte para contenido visual dinámico con Adaptive Cards y la posibilidad de recibir notificaciones push incluso cuando la aplicación no está en ejecución.&lt;/p>
&lt;p>Con &lt;strong>WinUI 3&lt;/strong> y &lt;strong>Windows App SDK&lt;/strong>, es posible crear y gestionar notificaciones enriquecidas, personalizadas y reactivas. Este artículo muestra cómo implementar notificaciones toast locales, cómo personalizarlas con Adaptive Cards, y cómo configurar notificaciones push para mantener al usuario informado en tiempo real.&lt;/p>
&lt;h2 id="requisitos">Requisitos&lt;/h2>
&lt;ul>
&lt;li>Windows 11&lt;/li>
&lt;li>Visual Studio 2022+&lt;/li>
&lt;li>Proyecto empaquetado con MSIX (WinUI 3)&lt;/li>
&lt;li>Windows App SDK 1.3 o superior&lt;/li>
&lt;li>Referencia a &lt;code>Microsoft.WindowsAppSDK&lt;/code> y &lt;code>Microsoft.Toolkit.Uwp.Notifications&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-instalar-el-paquete-nuget-para-notificaciones">Paso 1: Instalar el paquete NuGet para notificaciones&lt;/h2>
&lt;p>Agregar al proyecto el paquete:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Install-Package Microsoft.Windows.SDK.Contracts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Install-Package Microsoft.Toolkit.Uwp.Notifications
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto habilita la construcción de notificaciones toast con contenido enriquecido.&lt;/p>
&lt;h2 id="paso-2-enviar-una-notificación-toast-simple">Paso 2: Enviar una notificación toast simple&lt;/h2>
&lt;p>Agregar esta llamada en un evento de botón o al iniciar la app:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">new&lt;/span> &lt;span class="n">ToastContentBuilder&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Recordatorio&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;No olvides guardar tus cambios&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">Show&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto mostrará una notificación estándar en el Centro de Actividades.&lt;/p>
&lt;h2 id="paso-3-notificación-enriquecida-con-adaptive-card">Paso 3: Notificación enriquecida con Adaptive Card&lt;/h2>
&lt;p>Construir una tarjeta adaptativa (JSON):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">string&lt;/span> &lt;span class="n">adaptiveJson&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">@&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">{
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;type&amp;#34;&amp;#34;: &amp;#34;&amp;#34;AdaptiveCard&amp;#34;&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;version&amp;#34;&amp;#34;: &amp;#34;&amp;#34;1.5&amp;#34;&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;body&amp;#34;&amp;#34;: [
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> {
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;type&amp;#34;&amp;#34;: &amp;#34;&amp;#34;TextBlock&amp;#34;&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;text&amp;#34;&amp;#34;: &amp;#34;&amp;#34;Actualización disponible&amp;#34;&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;weight&amp;#34;&amp;#34;: &amp;#34;&amp;#34;Bolder&amp;#34;&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;size&amp;#34;&amp;#34;: &amp;#34;&amp;#34;Medium&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> },
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> {
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;type&amp;#34;&amp;#34;: &amp;#34;&amp;#34;TextBlock&amp;#34;&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;text&amp;#34;&amp;#34;: &amp;#34;&amp;#34;La versión 1.5 ya está lista para instalar.&amp;#34;&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;wrap&amp;#34;&amp;#34;: true
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> ],
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;actions&amp;#34;&amp;#34;: [
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> {
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;type&amp;#34;&amp;#34;: &amp;#34;&amp;#34;Action.OpenUrl&amp;#34;&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;title&amp;#34;&amp;#34;: &amp;#34;&amp;#34;Actualizar&amp;#34;&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&amp;#34;url&amp;#34;&amp;#34;: &amp;#34;&amp;#34;https://miapp.com/update&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> ]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">toastContent&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ToastContent&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Visual&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ToastVisual&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">BindingGeneric&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">ToastBindingGeneric&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Children&lt;/span> &lt;span class="p">=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">AdaptiveCardJsonContent&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">adaptiveJson&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ToastNotificationManagerCompat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateToastNotifier&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Show&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">ToastNotification&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">toastContent&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetXml&lt;/span>&lt;span class="p">()));&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Este código muestra una notificación visualmente rica y con botón de acción.&lt;/p>
&lt;h2 id="paso-4-manejar-la-activación-de-la-notificación">Paso 4: Manejar la activación de la notificación&lt;/h2>
&lt;p>Al pulsar sobre la notificación, se puede invocar código personalizado.&lt;/p>
&lt;p>Registrar manejador en &lt;code>App.xaml.cs&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">ToastNotificationManagerCompat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">OnActivated&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="n">toastArgs&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ToastArguments&lt;/span> &lt;span class="n">args&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">toastArgs&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Argument&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Lógica según argumentos&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;abrirPanel&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DispatcherQueue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TryEnqueue&lt;/span>&lt;span class="p">(()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">PanelWindow&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para enviar argumentos desde la notificación:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="p">.&lt;/span>&lt;span class="n">AddArgument&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;abrirPanel&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paso-5-notificaciones-push-via-canal-wns">Paso 5: Notificaciones push (via canal WNS)&lt;/h2>
&lt;h3 id="crear-canal">Crear canal&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">var&lt;/span> &lt;span class="n">channel&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">PushNotificationChannelManager&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreatePushNotificationChannelForApplicationAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Debug&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WriteLine&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;URI canal: &amp;#34;&lt;/span> &lt;span class="p">+&lt;/span> &lt;span class="n">channel&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Uri&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Este URI se registra en el servidor para enviar push desde un backend.&lt;/p>
&lt;h3 id="recibir-notificaciones-push">Recibir notificaciones push&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">channel&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PushNotificationReceived&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Mostrar notificación o actualizar UI&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">mensaje&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RawNotification&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Content&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto permite recibir actualizaciones incluso si la app está suspendida (con restricciones).&lt;/p>
&lt;h2 id="paso-6-permisos-y-manifiesto">Paso 6: Permisos y manifiesto&lt;/h2>
&lt;p>Asegurarse de declarar lo siguiente en el &lt;code>Package.appxmanifest&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.toastNotificationActivation&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:ToastNotificationActivation&lt;/span> &lt;span class="na">ToastActivatorCLSID=&lt;/span>&lt;span class="s">&amp;#34;YOUR-CLSID-HERE&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Y registrar el activador COM. Esto requiere el uso de un componente activador como &lt;code>AppNotificationActivator&lt;/code>.&lt;/p>
&lt;h2 id="paso-7-ejemplo-completo-con-interacción">Paso 7: Ejemplo completo con interacción&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">new&lt;/span> &lt;span class="n">ToastContentBuilder&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddArgument&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;action&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;abrirPanel&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Nuevo mensaje recibido&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Haz clic para abrir el panel de control&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddButton&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">ToastButton&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">SetContent&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Abrir ahora&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddArgument&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;action&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;abrirPanel&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">Show&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Y en el manejador:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;action&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;abrirPanel&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DispatcherQueue&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TryEnqueue&lt;/span>&lt;span class="p">(()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">PanelWindow&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>No abusar de las notificaciones para evitar fatiga del usuario&lt;/li>
&lt;li>Personalizar con íconos, logos e identidad visual&lt;/li>
&lt;li>Combinar con lógica de actividad para mostrar solo cuando el usuario está inactivo&lt;/li>
&lt;li>Permitir al usuario desactivar ciertos tipos de notificaciones&lt;/li>
&lt;li>Usar telemetría para medir tasa de clics y efectividad&lt;/li>
&lt;/ul>
&lt;h2 id="casos-de-uso">Casos de uso&lt;/h2>
&lt;ul>
&lt;li>Alertas de sistema o monitoreo en segundo plano&lt;/li>
&lt;li>Confirmaciones de procesos terminados&lt;/li>
&lt;li>Acciones rápidas desde el Centro de Actividades&lt;/li>
&lt;li>Integración con procesos push desde un backend o IoT&lt;/li>
&lt;li>UX reactiva sin abrir la ventana principal&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>La &lt;strong>API&lt;/strong> de notificaciones nativas de &lt;strong>Windows&lt;/strong>, junto con las Adaptive Cards y el soporte push, brinda una poderosa plataforma para interactuar con el usuario de manera contextual y no intrusiva. Usando &lt;strong>WinUI 3&lt;/strong> y &lt;strong>Windows App SDK&lt;/strong>, es posible ofrecer notificaciones enriquecidas, dinámicas y conectadas, reforzando el ciclo de comunicación entre la aplicación y el usuario.&lt;/p>
&lt;p>La integración adecuada de notificaciones no solo mejora la experiencia de usuario, sino que también posiciona a la aplicación como una parte activa del ecosistema Windows moderno.&lt;/p></description></item><item><title>Creación y gestión de accesos directos dinámicos en Start Menu y Taskbar</title><link>https://cmas.dev/posts/2024-12-13-winapp-dynamic-direct-access/</link><pubDate>Fri, 13 Dec 2024 00:00:00 -0400</pubDate><guid>https://cmas.dev/posts/2024-12-13-winapp-dynamic-direct-access/</guid><description>&lt;p>Una de las capacidades distintivas de las apps modernas en &lt;strong>Windows&lt;/strong> es la posibilidad de integrarse dinámicamente con la experiencia del sistema operativo. Esto incluye la creación de accesos directos personalizados en el menú de inicio (Start Menu), así como la integración con la barra de tareas (Taskbar), ofreciendo accesos rápidos a funciones internas de la aplicación.&lt;/p>
&lt;p>Gracias a &lt;strong>Windows App SDK&lt;/strong>, las apps desarrolladas con &lt;strong>WinUI 3&lt;/strong> pueden programáticamente crear y administrar accesos directos sin depender de métodos antiguos como acceso directo manual o scripts externos. Este artículo explora cómo crear accesos dinámicos con metadatos enriquecidos y cómo extender su funcionalidad mediante Jump Lists y pinning automático.&lt;/p>
&lt;h2 id="requisitos-previos">Requisitos previos&lt;/h2>
&lt;ul>
&lt;li>Windows 11&lt;/li>
&lt;li>Visual Studio 2022+&lt;/li>
&lt;li>Proyecto WinUI 3 empaquetado (MSIX) con Windows App SDK&lt;/li>
&lt;li>Conocimiento de archivos &lt;code>.lnk&lt;/code>, URIs internos y asociaciones de comandos&lt;/li>
&lt;/ul>
&lt;h2 id="escenario">Escenario&lt;/h2>
&lt;p>Una app de escritorio moderna llamada &amp;ldquo;NoteBoard&amp;rdquo; permite a los usuarios crear notas rápidas. El objetivo es ofrecer:&lt;/p>
&lt;ul>
&lt;li>Un acceso directo al menú inicio con el icono de la app&lt;/li>
&lt;li>Una opción adicional para crear una nueva nota desde la Jump List&lt;/li>
&lt;li>Pin automático a la barra de tareas al primer lanzamiento&lt;/li>
&lt;/ul>
&lt;h2 id="paso-1-configuración-de-acceso-directo-en-el-manifiesto-msix">Paso 1: Configuración de acceso directo en el manifiesto MSIX&lt;/h2>
&lt;p>Abrir el archivo &lt;code>Package.appxmanifest&lt;/code> en modo de texto y agregar la siguiente declaración dentro de &lt;code>&amp;lt;Applications&amp;gt;&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.appExecutionAlias&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:AppExecutionAlias&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:ExecutionAlias&lt;/span> &lt;span class="na">Alias=&lt;/span>&lt;span class="s">&amp;#34;noteboard.exe&amp;#34;&lt;/span> &lt;span class="nt">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:AppExecutionAlias&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Extensions&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto crea un alias ejecutable que puede ser llamado desde consola (&lt;code>noteboard.exe&lt;/code>) y ayuda en el pin dinámico.&lt;/p>
&lt;h2 id="paso-2-crear-uri-handlers-para-acciones-internas">Paso 2: Crear URI handlers para acciones internas&lt;/h2>
&lt;p>Declarar un protocolo personalizado en el manifiesto:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;uap:Extension&lt;/span> &lt;span class="na">Category=&lt;/span>&lt;span class="s">&amp;#34;windows.protocol&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:Protocol&lt;/span> &lt;span class="na">Name=&lt;/span>&lt;span class="s">&amp;#34;noteboard&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;uap:DisplayName&amp;gt;&lt;/span>NoteBoard Protocol&lt;span class="nt">&amp;lt;/uap:DisplayName&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/uap:Protocol&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/uap:Extension&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Y en código (ej. en &lt;code>App.xaml.cs&lt;/code>), capturar el URI:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">protected&lt;/span> &lt;span class="kd">override&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">OnActivated&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">IActivatedEventArgs&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">args&lt;/span> &lt;span class="k">is&lt;/span> &lt;span class="n">ProtocolActivatedEventArgs&lt;/span> &lt;span class="n">protocolArgs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">uri&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">protocolArgs&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Uri&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">uri&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Host&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;newnote&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Abrir ventana para nueva nota&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="n">MainWindow&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Activate&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Esto permite abrir la app con comandos como &lt;code>noteboard://newnote&lt;/code>.&lt;/p>
&lt;h2 id="paso-3-añadir-accesos-rápidos-a-la-jump-list">Paso 3: Añadir accesos rápidos a la Jump List&lt;/h2>
&lt;p>Usar la clase &lt;code>JumpList&lt;/code> para registrar tareas adicionales:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">Windows.UI.StartScreen&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span> &lt;span class="kd">async&lt;/span> &lt;span class="n">Task&lt;/span> &lt;span class="n">ConfigurarJumpListAsync&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">await&lt;/span> &lt;span class="n">JumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">IsSupportedAsync&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">jumpList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">await&lt;/span> &lt;span class="n">JumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">LoadCurrentAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Clear&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">var&lt;/span> &lt;span class="n">item&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">JumpListItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CreateWithArguments&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;noteboard://newnote&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Nueva Nota&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">item&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Description&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Crear una nueva nota rápida&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">item&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Logo&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Uri&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ms-appx:///Assets/plus-icon.png&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">item&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GroupName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;Accesos rápidos&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Items&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">await&lt;/span> &lt;span class="n">jumpList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SaveAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Invocar &lt;code>ConfigurarJumpListAsync()&lt;/code> en el primer inicio o durante la inicialización de la app.&lt;/p>
&lt;h2 id="paso-4-pin-a-la-barra-de-tareas-taskbar">Paso 4: Pin a la barra de tareas (Taskbar)&lt;/h2>
&lt;p>Este paso es más delicado. El pinning automático no está oficialmente soportado por la API pública, pero se puede sugerir mediante atajos:&lt;/p>
&lt;ul>
&lt;li>Crear un archivo &lt;code>.lnk&lt;/code> con destino a &lt;code>noteboard.exe&lt;/code>&lt;/li>
&lt;li>Usar &lt;code>ShellLink&lt;/code> con interop para crear el acceso&lt;/li>
&lt;li>Invitar al usuario a &amp;ldquo;Pin to taskbar&amp;rdquo; mediante UI o notificación&lt;/li>
&lt;/ul>
&lt;p>Ejemplo de creación del acceso directo vía &lt;code>IShellLink&lt;/code> (requiere COM interop):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Usar Shell32 o empaquetar un ejecutable auxiliar que cree el pin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Alternativamente, al iniciar la app por primera vez, se puede mostrar una notificación:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">new&lt;/span> &lt;span class="n">ToastContentBuilder&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;¿Usás NoteBoard frecuentemente?&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Anclala a la barra de tareas para acceder más rápido.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">AddButton&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="n">ToastButton&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Anclar&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;pin-taskbar&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="n">Show&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>En el manejador de activación, abrir el menú contextual del acceso directo.&lt;/p>
&lt;h2 id="paso-5-verificar-resultado-en-sistema">Paso 5: Verificar resultado en sistema&lt;/h2>
&lt;p>Después de correr la app:&lt;/p>
&lt;ul>
&lt;li>Presionar la tecla Windows y escribir &amp;ldquo;NoteBoard&amp;rdquo;&lt;/li>
&lt;li>El acceso directo aparecerá con el ícono personalizado&lt;/li>
&lt;li>Clic derecho mostrará la Jump List con &amp;ldquo;Nueva Nota&amp;rdquo;&lt;/li>
&lt;li>Ejecutar desde PowerShell: &lt;code>Start-Process &amp;quot;noteboard://newnote&amp;quot;&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="buenas-prácticas">Buenas prácticas&lt;/h2>
&lt;ul>
&lt;li>Usar logos diferenciados para cada JumpListItem&lt;/li>
&lt;li>No exceder los 5 accesos rápidos recomendados por Microsoft&lt;/li>
&lt;li>Localizar títulos y descripciones si la app es multilenguaje&lt;/li>
&lt;li>Guardar estado de pinning para evitar duplicados o repeticiones&lt;/li>
&lt;/ul>
&lt;h2 id="casos-de-uso">Casos de uso&lt;/h2>
&lt;ul>
&lt;li>Crear accesos directos para flujos frecuentes (crear nota, abrir calendario, iniciar reunión)&lt;/li>
&lt;li>Acciones rápidas en apps de productividad, CRM, helpdesk&lt;/li>
&lt;li>Activación de comandos por voz o scripts (via protocolo personalizado)&lt;/li>
&lt;li>Extensiones de UX sin necesidad de abrir UI completa&lt;/li>
&lt;/ul>
&lt;h2 id="conclusión">Conclusión&lt;/h2>
&lt;p>Las apps modernas en &lt;strong>Windows&lt;/strong> pueden integrarse profundamente con el sistema operativo a través de accesos directos dinámicos, Jump Lists, protocolos personalizados y atajos enriquecidos. Usando &lt;strong>Windows App SDK&lt;/strong>, es posible ofrecer al usuario una experiencia nativa y fluida desde el inicio, mejorando la productividad y facilitando el acceso a las funcionalidades clave de la aplicación desde el menú de inicio o la barra de tareas.&lt;/p>
&lt;p>Esta integración es una forma efectiva de mejorar la adopción y visibilidad de una app, ofreciendo puntos de entrada estratégicos que van más allá de la simple ejecución principal.&lt;/p></description></item><item><title>Usando MAUI con Windows App SDK</title><link>https://cmas.dev/posts/2022-11-02-windows-app-using-maui/</link><pubDate>Wed, 02 Nov 2022 23:42:00 -0400</pubDate><guid>https://cmas.dev/posts/2022-11-02-windows-app-using-maui/</guid><description>&lt;p>En este artículo veremos cómo &lt;strong>.NET MAUI&lt;/strong> interactúa con &lt;strong>Windows 11&lt;/strong> sin necesidad de funciones extras ni código para llegar a ese resultado.&lt;/p>
&lt;p>&lt;em>&lt;strong>Windows 11 Insider Preview Build 25236&lt;/strong>&lt;/em>&lt;/p>
&lt;p>Hemos visto en varios artículos anteriores, detalles sobre &lt;strong>.NET MAUI&lt;/strong>, pero aquí me surge la necesidad de saber qué pasa en el caso de Windows cuando, por ejemplo, necesitamos acceder al sistema de archivos. ¿Qué pasa? Comparando con &lt;strong>Android&lt;/strong> ¿Cómo se comporta? Seguí leyendo y veamos.&lt;/p>
&lt;h2 id="abrir-imagen-en-windows-11">Abrir imagen en Windows 11&lt;/h2>
&lt;p>Con estos pasos lograremos abrir un archivo y cargarlo en nuestro diseño.&lt;/p>
&lt;ol>
&lt;li>Creamos el método que permite abrir los archivos en el Windows:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">private&lt;/span> &lt;span class="n">async&lt;/span> &lt;span class="n">Task&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">FileResult&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">PickAndShow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PickOptions&lt;/span> &lt;span class="n">options&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">try&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">var&lt;/span> &lt;span class="n">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">await&lt;/span> &lt;span class="n">FilePicker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Default&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PickAsync&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">options&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">FileName&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">EndsWith&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;jpg&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">StringComparison&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OrdinalIgnoreCase&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">FileName&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">EndsWith&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;png&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">StringComparison&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OrdinalIgnoreCase&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">using&lt;/span> &lt;span class="k">var&lt;/span> &lt;span class="n">stream&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">await&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OpenReadAsync&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">var&lt;/span> &lt;span class="n">image&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ImageSource&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">FromStream&lt;/span>&lt;span class="p">(()&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="n">stream&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">result&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">catch&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Exception&lt;/span> &lt;span class="n">ex&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">throw&lt;/span> &lt;span class="n">ex&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>Hacemos la llamada al método y el resultado lo exponemos en la imagen principal:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">private&lt;/span> &lt;span class="n">async&lt;/span> &lt;span class="n">void&lt;/span> &lt;span class="n">OnCounterClicked&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">object&lt;/span> &lt;span class="n">sender&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">EventArgs&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">var&lt;/span> &lt;span class="n">resultado&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">await&lt;/span> &lt;span class="n">PickAndShow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PickOptions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Images&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">imgLogo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Source&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ImageSource&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">new&lt;/span> &lt;span class="n">ImageSourceConverter&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ConvertFromString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">resultado&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">FullPath&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>Hicimos un cambio en el XAML, colocamos un nombre a la imagen para poder reemplazar el &lt;em>Source&lt;/em> de dicha imagen:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;Image
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> x:Name=&amp;#34;imgLogo&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Source=&amp;#34;dotnet_bot.png&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> SemanticProperties.Description=&amp;#34;Cute dot net bot waving hi to you!&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> HeightRequest=&amp;#34;200&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> HorizontalOptions=&amp;#34;Center&amp;#34; /&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>Ejecutamos la aplicación y vemos los resultados:
&lt;img src="https://cmas.dev/img/posts/2022/11/02/1.png" alt="">&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://cmas.dev/img/posts/2022/11/02/2.png" alt="">&lt;/p>
&lt;p>&lt;img src="https://cmas.dev/img/posts/2022/11/02/3.png" alt="">&lt;/p>
&lt;h2 id="abrir-imagen-en-android">Abrir imagen en Android&lt;/h2>
&lt;p>Como todo esto lo hicimos con &lt;strong>.NET MAUI&lt;/strong>, debemos hacer ¡NADA!&lt;/p>
&lt;ol>
&lt;li>Ejecutamos en &lt;strong>Android&lt;/strong> y&amp;hellip;
&lt;img src="https://cmas.dev/img/posts/2022/11/02/4.png" alt="">&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://cmas.dev/img/posts/2022/11/02/5.png" alt="">&lt;/p>
&lt;p>&lt;img src="https://cmas.dev/img/posts/2022/11/02/6.png" alt="">&lt;/p>
&lt;p>Con una única línea de código pudimos realizar esta tarea sencilla sin necesidad de solicitar permisos ni nada desde la aplicación. esa es una de las ventajas que me gusta de &lt;strong>.NET MAUI&lt;/strong>&lt;/p>
&lt;p>¡Espero resulte útil!&lt;/p></description></item><item><title>Estructura básica de un proyecto con Windows App SDK</title><link>https://cmas.dev/posts/2022-05-25-basic-struct-of-windows-app-sdk-project/</link><pubDate>Wed, 25 May 2022 18:45:00 -0400</pubDate><guid>https://cmas.dev/posts/2022-05-25-basic-struct-of-windows-app-sdk-project/</guid><description>&lt;p>En este artículo intentaré explicar lo que entiendo es la estructura básica de &lt;strong>Windows App SDK&lt;/strong>, pues resulta algo nuevo para mí (en el pasado desarrollaba con WPF y después con UWP en sus inicios). En un &lt;a href="https://cmas.dev/posts/2022-05-18-windows-app-sdk-development/">artículo anterior&lt;/a> hemos visto los primeros pasos en esta plataforma.&lt;/p>
&lt;p>&lt;em>&lt;strong>Windows 11 Insider Preview Build 25126&lt;/strong>&lt;/em>&lt;/p>
&lt;p>Según la definición tenemos que esta definición:&lt;/p>
&lt;blockquote>
&lt;p>Windows App SDK es un conjunto de nuevos componentes y herramientas para desarrolladores que representan la próxima evolución en la plataforma de desarrollo de aplicaciones de Windows. Windows App SDK proporciona un conjunto unificado de API y herramientas que se pueden usar de manera consistente por cualquier aplicación de escritorio en Windows 11 y versiones anteriores hasta Windows 10, versión 1809&lt;/p>
&lt;/blockquote>
&lt;p>Rápidamente podemos entender que su estructura básica se compone de:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Foundation&lt;/strong>: es la capa que ofrece las &lt;em>API&lt;/em> básicas para acceder a las características y servicios de &lt;em>Windows&lt;/em>, como la configuración del sistema, el almacenamiento de datos, la red y la seguridad.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>UI&lt;/strong>: es la capa que ofrece los controles y componentes de interfaz de usuario para crear aplicaciones modernas y atractivas en &lt;em>Windows&lt;/em>, como &lt;em>XAML Islands&lt;/em>, &lt;em>WinUI 3&lt;/em> y &lt;em>WebView2&lt;/em>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Frameworks&lt;/strong>: es la capa que ofrece los marcos de trabajo y patrones para facilitar el desarrollo de aplicaciones en &lt;em>Windows&lt;/em>, como &lt;em>App Lifecycle&lt;/em>, &lt;em>Push Notifications&lt;/em> y &lt;em>Reunion Windowing&lt;/em>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Tools&lt;/strong>: es la capa que ofrece las extensiones y plantillas para Visual Studio 2022 que permiten usar los componentes de &lt;strong>Windows App SDK&lt;/strong> en proyectos nuevos o existentes. También incluye un paquete &lt;em>NuGet&lt;/em> que contiene las bibliotecas de Windows App SDK.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="diferencias-entre-win32-apis-y-uwp-apis">Diferencias entre Win32 APIs y UWP APIs&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Win32 APIs&lt;/strong>: son las API de &lt;em>Windows&lt;/em> que se usan para crear aplicaciones de escritorio tradicionales en C++ o C#. Algunas de estas &lt;em>API&lt;/em> son: &lt;em>CreateWindowEx&lt;/em>, &lt;em>MessageBox&lt;/em>, &lt;em>ShellExecute&lt;/em>, etc.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>UWP APIs&lt;/strong>: son las API de &lt;em>Windows&lt;/em> que se usan para crear aplicaciones universales que pueden ejecutarse en diferentes dispositivos con &lt;strong>Windows 11&lt;/strong>. Algunas de estas API son: &lt;em>Windows.UI.Xaml.Controls&lt;/em>, &lt;em>Windows.Media.Capture&lt;/em>, &lt;em>Windows.Storage&lt;/em>, etc.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Windows App SDK&lt;/strong> permite usar ambas API en una misma aplicación, lo que ofrece más flexibilidad y compatibilidad a los desarrolladores1.&lt;/p>
&lt;p>Esta es una pequeña introducción (con sabor a trabajo práctico) sobre Windows App SDK. A partir de esto se vienen muchos artículos sobre este &lt;em>SDK&lt;/em>.&lt;/p>
&lt;p>¡Espero resulte útil!&lt;/p></description></item></channel></rss>